> > > > > > > > > > 
> 
> 
> 
> 
> #load tornado average length data Vs the year to an object 'tornlen'
> 
> 
> tornlen=read.table("torn-length-monthly-data.csv",header=T,sep=',')
> 
> tornlen=tornlen[sample(nrow(tornlen)),]
> 
> #selecting 80% of the  shuffled data as training data
> 
> 
> select.data=sample(1:nrow(tornlen),0.8*nrow(tornlen))
> 
> #assigning the test and training datasets to objects
> 
> 
> train.data=tornlen[select.data,]
> test.data=tornlen[-select.data,]
> 
> 
> #assigning the length and date parameters
> 
> 
> avglen=train.data$avglength
> year=train.data$date
> 
> 
> #creating time series object
> 
> 
> tornlents=ts(avglen,start=c(1950,1),frequency=12)
> 
> 
> basicStats(tornlents)
              tornlents
nobs         643.000000
NAs            0.000000
Minimum        0.100000
Maximum       30.206667
1. Quartile    1.766951
3. Quartile    4.877291
Mean           3.833215
Median         2.928704
Sum         2464.757410
SE Mean        0.129521
LCL Mean       3.578880
UCL Mean       4.087550
Variance      10.786704
Stdev          3.284312
Skewness       2.956306
Kurtosis      15.010883
> 
> 
> #verify if the time series data follow normal distribution
> 
> 
> par(mfcol=c(2,2))
> hist(avglen,xlab="Average tornado length",prob=TRUE,main="Histogram of tornado length over years")
> xfit<-seq(min(avglen),max(avglen),length=40)
> yfit<-dnorm(xfit,mean=mean(avglen),sd=sd(avglen))
> lines(xfit,yfit,col='blue',lwd=2)
> 
> 
> #Use QQ Plot as well to check if the average length of tornadoes follow normal distribution
> qqnorm(avglen)
> qqline(coredata(avglen),col=3)
> 
> 
> #Use Jarque Bera test
> 
> jarque.bera.test(avglen)

        Jarque Bera Test

data:  avglen
X-squared = 7023.1, df = 2, p-value < 2.2e-16

> 
> #create plot of average length and plot of average length time series object too
> 
> plot(avglen,main='Average Length Plot")

+ > plot(avglen,main="Average Length Plot")
> 
> plot(tornlents,main="Average Length over years")
> 
> 
> #plot to verify the stationarity assumption of the data
> 
> acf(avglen,plot=F,lag.max=20,na.action=na.pass)

Autocorrelations of series ‘avglen’, by lag

     0      1      2      3      4      5      6      7      8      9     10     11     12 
 1.000 -0.048 -0.040 -0.002 -0.036 -0.030 -0.025 -0.047  0.048  0.070 -0.020  0.024  0.001 
    13     14     15     16     17     18     19     20 
-0.055  0.000 -0.035 -0.001 -0.008 -0.054 -0.024  0.082 
> pacf(avglen,plot=F,lag.max=20,na.action=na.pass)

Partial autocorrelations of series ‘avglen’, by lag

     1      2      3      4      5      6      7      8      9     10     11     12     13 
-0.048 -0.042 -0.006 -0.039 -0.035 -0.032 -0.054  0.039  0.068 -0.013  0.023  0.002 -0.049 
    14     15     16     17     18     19     20 
-0.001 -0.031  0.000 -0.021 -0.062 -0.037  0.065 
> acf(avglen,plot=T,lag.max=20,na.action=na.pass)
> pacf(avglen,plot=T,lag.max=20,na.action=na.pass)
> 
> #Ljung Box test for serial correlation
> 
> Box.test(avglen,lag=6,type='Ljung')

        Box-Ljung test

data:  avglen
X-squared = 4.3866, df = 6, p-value = 0.6245

> Box.test(avglen,lag=12,type='Ljung')

        Box-Ljung test

data:  avglen
X-squared = 11.196, df = 12, p-value = 0.5122

> #since the data doesn't meet the basic assumptions, we are applying transformation on the average length data
> #to make the time series data to meet the assumptions
> #Applying log transformation to the average length data
> 
> loglen=log(avglen+1)
> loglents=log(tornlents+1)
> 
> 
> #view the basic stats of the log transformed length data
> 
> basicStats(loglen)
                loglen
nobs        643.000000
NAs           0.000000
Minimum       0.095310
Maximum       3.440632
1. Quartile   1.017746
3. Quartile   1.771096
Mean          1.412599
Median        1.368310
Sum         908.300908
SE Mean       0.021627
LCL Mean      1.370130
UCL Mean      1.455067
Variance      0.300749
Stdev         0.548406
Skewness      0.438856
Kurtosis      0.205962
> basicStats(loglents)
              loglents
nobs        643.000000
NAs           0.000000
Minimum       0.095310
Maximum       3.440632
1. Quartile   1.017746
3. Quartile   1.771096
Mean          1.412599
Median        1.368310
Sum         908.300908
SE Mean       0.021627
LCL Mean      1.370130
UCL Mean      1.455067
Variance      0.300749
Stdev         0.548406
Skewness      0.438856
Kurtosis      0.205962
> #perform the normality tests to confirm if the log transformed data follows normal distribution
> 
> #Jarque Bera Test
> 
> jarque.bera.test(loglen)

        Jarque Bera Test

data:  loglen
X-squared = 21.986, df = 2, p-value = 1.682e-05

> jarque.bera.test(loglents)

        Jarque Bera Test

data:  loglents
X-squared = 21.986, df = 2, p-value = 1.682e-05

> 
> #QQ Plot
> qqnorm(loglen)
> qqline(coredata(loglen),col=2)
> 
> 
> #Histogram
> 
> hist(loglents,xlab="Average tornado log length",prob=TRUE,main="Histogram of tornado log length over years")
> xfit<-seq(min(loglen),max(loglen),length=40)
> yfit<-dnorm(xfit,mean=mean(loglen),sd=sd(loglen))
> lines(xfit,yfit,col="red",lwd=2)
> 
> 
> #time plots
> 
> plot(loglen,main="Log Length ")
> plot(loglents,main="Log Length over Years")
> 
> 
> #acf and pacf plots to confirm stationarity and serial correlation
> 
> acf(loglen,plot=F,lag.max=20,na.action=na.pass)

Autocorrelations of series ‘loglen’, by lag

     0      1      2      3      4      5      6      7      8      9     10     11     12 
 1.000 -0.053 -0.033 -0.010 -0.034 -0.037 -0.010 -0.076  0.060  0.082 -0.036 -0.001 -0.004 
    13     14     15     16     17     18     19     20 
-0.034 -0.015 -0.015 -0.008  0.020 -0.039 -0.029  0.091 
> pacf(loglen,plot=F,lag.max=20,na.action=na.pass)

Partial autocorrelations of series ‘loglen’, by lag

     1      2      3      4      5      6      7      8      9     10     11     12     13 
-0.053 -0.036 -0.014 -0.036 -0.042 -0.017 -0.082  0.048  0.080 -0.029 -0.004 -0.006 -0.029 
    14     15     16     17     18     19     20 
-0.019 -0.012 -0.004  0.002 -0.047 -0.032  0.081 
> acf(loglen,plot=T,lag.max=20,na.action=na.pass)
> pacf(loglen,plot=T,lag.max=20,na.action=na.pass)
> acf(coredata(loglen),plot=T,lag.max=20,na.action=na.pass)
> acf(coredata(loglen),plot=T,lag.max=20)
> par(mfcol=c(2,2))
> acf(coredata(loglen),plot=T,lag.max=20,na.action=na.pass)
> pacf(coredata(loglen),plot=T,lag.max=20,na.action=na.pass)
> plot(loglen,main="Log Length ")
> plot(loglents,main="Log Length over Years")
> 
> 
> 
> #Ljung Box test for serial correlation
> 
> Box.test(loglen,lag=6,type='Ljung')

        Box-Ljung test

data:  loglen
X-squared = 4.2914, df = 6, p-value = 0.6373

> Box.test(loglen,lag=12,type='Ljung')

        Box-Ljung test

data:  loglen
X-squared = 15.664, df = 12, p-value = 0.2071

> Box.test(loglen,lag=20,type='Ljung')

        Box-Ljung test

data:  loglen
X-squared = 24.169, df = 20, p-value = 0.2351

> Box.test(loglen,lag=18,type='Ljung')

        Box-Ljung test

data:  loglen
X-squared = 18.09, df = 18, p-value = 0.4497

> train.data
         date  avglength
454 10/1/1987  0.2000000
468 12/1/1988  4.3550000
128  8/1/1960  1.2791667
149  5/1/1962  3.9899038
774  6/1/2014  2.4892096
66   6/1/1955  5.7393548
91   7/1/1957  2.6327273
208  4/1/1967  5.2823377
270  6/1/1972  1.8938596
370 10/1/1980  4.1465116
41   5/1/1953 12.6029412
573  9/1/1997  1.7687500
204 12/1/1966  0.8090909
75   3/1/1956  1.7419355
299 11/1/1974  2.0307692
108 12/1/1958  0.1000000
618  6/1/2001  1.5891566
770  2/1/2014  4.1788095
746  2/1/2012  7.6421311
559  7/1/1996  1.4106796
272  8/1/1972  2.0338983
316  4/1/1976  4.7318966
49   1/1/1954 11.4500000
374  2/1/1981  2.8600000
562 10/1/1996  3.5191176
714  6/1/2009  1.5418248
227 11/1/1968 11.9590909
206  2/1/1967  0.2000000
143 11/1/1961  2.3944444
195  3/1/1966 30.2066667
412  4/1/1984  4.4485876
152  8/1/1962  3.3196078
576 12/1/1997  1.9166667
656  8/1/2004  1.5882682
477  9/1/1989  1.1225806
228 12/1/1968  2.8156250
658 10/1/2004  2.4772152
35  11/1/1952 10.3666667
360 12/1/1979  1.1000000
218  2/1/1968  1.8428571
43   7/1/1953  1.5718750
549  9/1/1995  1.6842105
627  3/1/2002  3.1021277
348 12/1/1978  9.1937500
801  9/1/2016  1.7000000
403  7/1/1983  1.1656566
123  3/1/1960  5.4285714
702  6/1/2008  2.9835690
382 10/1/1981  2.1406250
456 12/1/1987  5.1812500
386  2/1/1982  0.4000000
759  3/1/2013  3.6350000
795  3/1/2016  2.9386667
740  8/1/2011  1.3971667
273  9/1/1972  6.9117647
704  8/1/2008  1.3125243
478 10/1/1989  3.1866667
736  4/1/2011  7.7008446
334 10/1/1977  4.2360000
461  5/1/1988  4.8736842
387  3/1/1982 10.7500000
751  7/1/2012  1.5313514
186  6/1/1965  2.7523810
337  1/1/1978  5.5130435
44   8/1/1953  1.5333333
209  5/1/1967  1.8974138
709  1/1/2009  1.5850000
441  9/1/1986  2.2835821
234  6/1/1969  4.9605839
575 11/1/1997  2.2920000
413  5/1/1984  3.3428571
141  9/1/1961  4.0436364
539 11/1/1994  5.2595238
384 12/1/1981  4.7000000
380  8/1/1981  0.8250000
13   1/1/1951 11.2500000
116  8/1/1959  1.6500000
566  2/1/1997  3.0826087
150  6/1/1962  2.3251462
304  4/1/1975  2.9638889
376  4/1/1981  6.5809524
253  1/1/1971  1.4578947
524  8/1/1993  1.7660714
37   1/1/1953  6.4214286
255  3/1/1971  5.7357143
574 10/1/1997  2.6911765
555  3/1/1996  4.9718310
344  8/1/1978  3.7910448
662  2/1/2005  1.3300000
343  7/1/1978  2.7321678
34  10/1/1952  7.0821138
25   1/1/1952  1.5416667
722  2/1/2010  0.5000000
594  6/1/1999  1.7768166
293  5/1/1974  4.5194444
184  4/1/1965 11.2000000
611 11/1/2000  2.5300000
665  5/1/2005  1.4360656
335 11/1/1977  1.5791667
298 10/1/1974  4.0400000
531  3/1/1994  9.5000000
553  1/1/1996  1.7885714
443 11/1/1986  6.2823529
698  2/1/2008  6.9781013
757  1/1/2013  4.3919753
103  7/1/1958  2.5918699
355  7/1/1979  1.3295455
300 12/1/1974  3.6625000
790 10/1/2015  2.0467500
48  12/1/1953 13.4304348
233  5/1/1969  3.9689655
67   7/1/1955  3.3061224
179 11/1/1964  5.2210526
352  4/1/1979  7.6503817
61   1/1/1955  1.0666667
675  3/1/2006  7.6787500
257  5/1/1971  6.0523256
779 11/1/2014  8.9628000
165  9/1/1963 11.0600000
715  7/1/2009  2.2141600
639  3/1/2003  2.5767442
730 10/1/2010  3.3982727
435  3/1/1986  5.5500000
424  4/1/1985  2.5022059
54   6/1/1954  2.9710280
491 11/1/1990  3.6388889
737  5/1/2011  4.2281899
607  7/1/2000  1.2777027
69   9/1/1955  3.1400000
777  9/1/2014  3.4114634
522  6/1/1993  2.7160377
86   2/1/1957  0.5600000
612 12/1/2000  5.0807692
590  2/1/1999  3.9375000
287 11/1/1973  5.2654321
222  6/1/1968  2.7760870
279  3/1/1973  6.6402439
703  7/1/2008  2.5293204
2    2/1/1950 13.3619048
727  7/1/2010  2.4360959
708 12/1/2008  3.1941304
743 11/1/2011  6.6096078
214 10/1/1967  2.7888889
525  9/1/1993  3.3753846
216 12/1/1967  5.8462687
194  2/1/1966  2.1178571
148  4/1/1962  5.7365854
219  3/1/1968  1.8107143
634 10/1/2002  1.5189655
563 11/1/1996  3.3109091
768 12/1/2013  8.2010000
77   5/1/1956  3.4455696
160  4/1/1963  8.8188889
541  1/1/1995  2.9111111
769  1/1/2014  1.8225000
677  5/1/2006  1.5720280
190 10/1/1965  1.2312500
434  2/1/1986  2.3233333
312 12/1/1975  4.4090909
705  9/1/2008  1.2764865
598 10/1/1999  0.8411765
515 11/1/1992  8.9858065
597  9/1/1999  1.3303571
700  4/1/2008  3.1365969
610 10/1/2000  2.7468750
536  8/1/1994  2.0241667
663  3/1/2005  1.9967742
492 12/1/1990  5.6971429
347 11/1/1978  0.4000000
308  8/1/1975  2.1266667
224  8/1/1968  4.1676471
251 11/1/1970  6.3600000
448  4/1/1987  3.1400000
745  1/1/2012  3.9977215
543  3/1/1995  0.8653061
53   5/1/1954  5.9514286
80   8/1/1956  4.0476190
281  5/1/1973  6.5964706
787  7/1/2015  1.9266387
614  2/1/2001  8.6870968
526 10/1/1993  1.6454545
469  1/1/1989  4.6294118
325  1/1/1977  0.3000000
786  6/1/2015  2.4818085
497  5/1/1991  1.5265672
250 10/1/1970  3.5730769
274 10/1/1972  1.6558824
16   4/1/1951  4.5615385
429  9/1/1985  1.6875000
583  7/1/1998  1.0524390
638  2/1/2003  0.9500000
696 12/1/2007  2.1147368
689  5/1/2007  3.0844706
197  5/1/1966  2.0326531
203 11/1/1966  6.0050000
322 10/1/1976  2.0272727
254  2/1/1971 11.9333333
654  6/1/2004  1.8790441
650  2/1/2004  2.9777778
772  4/1/2014  6.3180714
278  2/1/1973  1.1500000
269  5/1/1972  2.0271429
117  9/1/1959  4.9790323
280  4/1/1973  4.4841060
471  3/1/1989  5.2755556
362  2/1/1980  4.3363636
55   7/1/1954  2.8311111
421  1/1/1985  0.7500000
182  2/1/1965  9.6735294
122  2/1/1960  4.9928571
788  8/1/2015  1.2406667
796  4/1/2016  3.0102837
282  6/1/1973  2.0129464
713  5/1/2009  2.5144776
115  7/1/1959  1.1285714
668  8/1/2005  2.3430894
756 12/1/2012  4.7761111
518  2/1/1993  5.2676471
731 11/1/2010  3.5978182
707 11/1/2008  2.8613333
330  6/1/1977  2.8365672
189  9/1/1965  2.6593750
631  7/1/2002  1.1779412
720 12/1/2009  2.3790000
483  3/1/1990 10.1076923
26   2/1/1952  3.3222222
508  4/1/1992  1.7830189
153  9/1/1962  0.8708333
490 10/1/1990  2.0342857
125  5/1/1960  4.7024752
480 12/1/1989  3.4666667
185  5/1/1965  6.4076087
742 10/1/2011  2.3873913
302  2/1/1975  6.5488889
462  6/1/1988  1.1222222
395 11/1/1982  2.1894737
151  7/1/1962  2.5137500
405  9/1/1983  0.9157895
581  5/1/1998  2.7802548
589  1/1/1999  5.2151376
446  2/1/1987  4.9263158
734  2/1/2011  3.8044776
466 10/1/1988  1.2684211
561  9/1/1996  1.5326733
636 12/1/2002  2.8485149
509  5/1/1992  1.9832117
364  4/1/1980  4.5742857
732 12/1/2010  4.9937838
534  6/1/1994  2.3571429
615  3/1/2001  4.9176471
331  7/1/1977  3.4495050
674  2/1/2006  1.8583333
781  1/1/2015  2.4614286
176  8/1/1964  2.9037975
63   3/1/1955  8.8000000
739  7/1/2011  2.0337864
547  7/1/1995  1.5817073
608  8/1/2000  0.9574074
56   8/1/1954  4.4938776
499  7/1/1991  0.9060606
706 10/1/2008  1.4295238
642  6/1/2003  1.2212329
540 12/1/1994  1.3000000
586 10/1/1998  3.2802326
231  3/1/1969  0.3750000
345  9/1/1978  4.1454545
10  10/1/1950  8.9000000
486  6/1/1990  3.8897661
397  1/1/1983  3.0307692
388  4/1/1982  5.0039216
514 10/1/1992  1.3058824
89   5/1/1957  5.5612069
147  3/1/1962  3.5108108
264 12/1/1971  5.2750000
15   3/1/1951  7.3000000
633  9/1/2002  3.5400000
585  9/1/1998  2.0538462
460  4/1/1988  2.8051724
552 12/1/1995  1.0500000
775  7/1/2014  2.4932184
437  5/1/1986  1.9289017
130 10/1/1960  1.5166667
506  2/1/1992  1.0758621
336 12/1/1977  5.0652174
112  4/1/1959  2.0200000
361  1/1/1980  0.2800000
697  1/1/2008  5.4723864
171  3/1/1964  8.4444444
544  4/1/1995  1.5753846
30   6/1/1952  9.5617647
377  5/1/1981  3.3486631
391  7/1/1982  0.9452632
131 11/1/1960  6.4000000
445  1/1/1987  1.1166667
158  2/1/1963  0.3400000
701  5/1/2008  5.1183966
181  1/1/1965  1.4809524
118 10/1/1959  5.4291667
623 11/1/2001  5.7651786
126  6/1/1960  3.4008000
474  6/1/1989  2.0901575
79   7/1/1956  2.9393617
129  9/1/1960  1.5571429
100  4/1/1958  7.6243590
680  8/1/2006  2.7175000
88   4/1/1957  7.1881279
767 11/1/2013  7.6774390
472  4/1/1989  2.2951220
359 11/1/1979  5.5095238
307  7/1/1975  1.2797468
127  7/1/1960  1.8380952
507  3/1/1992  3.9527273
619  7/1/2001  2.2558333
320  8/1/1976  0.3868421
510  6/1/1992  1.7678304
411  3/1/1984  6.7189873
351  3/1/1979  4.5909091
404  8/1/1983  1.0263158
102  6/1/1958  2.5984375
132 12/1/1960 11.0000000
712  4/1/2009  4.0722222
482  2/1/1990  2.4842105
241  1/1/1970  0.4555556
519  3/1/1993  1.9604167
285  9/1/1973 11.1319444
82  10/1/1956 12.7161290
262 10/1/1971  4.8263158
93   9/1/1957  6.6764706
114  6/1/1959  1.7917808
400  4/1/1983  4.4323077
657  9/1/2004  2.6888525
309  9/1/1975  1.5882353
263 11/1/1971  4.9812500
659 11/1/2004  3.8987013
162  6/1/1963  1.9766667
733  1/1/2011  5.4568750
3    3/1/1950  8.8521739
754 10/1/2012  2.5386486
232  4/1/1969  9.7013158
135  3/1/1961  9.0914729
670 10/1/2005  3.8277778
140  8/1/1961  1.4000000
455 11/1/1987  6.4403509
512  8/1/1992  1.5330435
438  6/1/1986  1.4201493
205  1/1/1967  7.1658537
431 11/1/1985  3.7315789
629  5/1/2002  1.8129808
237  9/1/1969  1.1950000
31   7/1/1952  7.6517241
104  8/1/1958  4.2565217
584  8/1/1998  1.8650794
50   2/1/1954  6.5294118
7    7/1/1950  3.3173913
637  1/1/2003  3.1627562
295  7/1/1974  1.6457627
673  1/1/2006  2.5000000
729  9/1/2010  1.7879661
641  5/1/2003  4.8795812
87   3/1/1957  2.9473684
187  7/1/1965  1.3229885
169  1/1/1964  1.3285714
802 10/1/2016  4.0009091
29   5/1/1952  3.5441176
40   4/1/1953 10.7807692
494  2/1/1991  2.2363636
6    6/1/1950  6.9714286
571  7/1/1997  1.4894737
78   6/1/1956  2.7723077
97   1/1/1958  1.1090909
676  4/1/2006  4.0197674
101  5/1/1958  6.8541667
83  11/1/1956  0.7142857
332  8/1/1977  3.6792683
290  2/1/1974  3.8869565
175  7/1/1964  1.5476190
793  1/1/2016  2.9441176
410  2/1/1984  0.9481481
137  5/1/1961  6.8152778
286 10/1/1973  4.6120000
139  7/1/1961  4.1050000
402  6/1/1983  1.9300000
596  8/1/1999  1.8620253
564 12/1/1996  1.1800000
105  9/1/1958  1.1041667
110  2/1/1959  5.8045455
183  3/1/1965 10.5666667
748  4/1/2012  4.2208252
647 11/1/2003  3.2200000
297  9/1/1974  1.0320000
36  12/1/1952 16.6800000
136  4/1/1961  9.7354430
267  3/1/1972  2.1971014
236  8/1/1969  3.2985714
613  1/1/2001  0.7200000
4    4/1/1950  6.2666667
106 10/1/1958 12.9700000
92   8/1/1957  1.2400000
196  4/1/1966  5.8098765
644  8/1/2003  0.9000000
52   4/1/1954 11.5360656
90   6/1/1957  4.2476510
247  7/1/1970  1.8259259
532  4/1/1994  2.0685990
167 11/1/1963  2.5000000
124  4/1/1960  4.8750000
635 11/1/2002  8.0932039
161  5/1/1963  3.0315068
173  5/1/1964  6.0398551
350  2/1/1979  4.1500000
764  8/1/2013  3.1524444
423  3/1/1985  1.1894737
235  7/1/1969  2.0653061
773  5/1/2014  2.3668462
155 11/1/1962  1.2400000
744 12/1/2011  5.1320000
551 11/1/1995  2.0164557
439  7/1/1986  3.9543478
240 12/1/1969  3.9217391
667  7/1/2005  1.6717391
268  4/1/1972  6.1210000
201  9/1/1966  0.8000000
529  1/1/1994  1.3538462
288 12/1/1973  5.9285714
546  6/1/1995  1.4324324
420 12/1/1984  3.6500000
94  10/1/1957  5.8388889
624 12/1/2001  1.8136364
685  1/1/2007  2.5852381
113  5/1/1959  4.2815789
560  8/1/1996  1.3402778
660 12/1/2004  3.5178571
170  2/1/1964  1.9500000
723  3/1/2010  3.4033333
587 11/1/1998  1.9928571
728  8/1/2010  2.2277193
399  3/1/1983  3.1830986
778 10/1/2014  2.6072603
588 12/1/1998  1.3666667
684 12/1/2006  4.9573810
401  5/1/1983  2.9847059
417  9/1/1984  2.2411765
363  3/1/1980  3.6439024
353  5/1/1979  1.7892857
765  9/1/2013  1.0323810
436  4/1/1986  2.6465116
669  9/1/2005  2.6496241
528 12/1/1993  5.7833333
70  10/1/1955  4.5347826
292  4/1/1974 12.4151203
265  1/1/1972  5.2212121
671 11/1/2005  4.6366013
504 12/1/1991  4.3666667
467 11/1/1988  5.7852459
346 10/1/1978  2.9857143
463  7/1/1988  0.9757282
688  4/1/2007  3.7795266
191 11/1/1965  4.9166667
418 10/1/1984  4.3448980
72  12/1/1955 15.1000000
752  8/1/2012  1.2418421
305  5/1/1975  2.5750000
593  5/1/1999  3.4745283
398  2/1/1983  2.3219512
622 10/1/2001  3.8099174
306  6/1/1975  3.9642857
632  8/1/2002  1.1709302
771  3/1/2014  2.5000000
11  11/1/1950  4.5250000
159  3/1/1963  7.8431373
785  5/1/2015  3.3251407
18   6/1/1951  5.4763158
333  9/1/1977  2.1253731
65   5/1/1955  5.7862745
558  6/1/1996  1.3359375
365  5/1/1980  3.8815534
804 12/1/2016  2.2889474
392  8/1/1982  2.8382353
19   7/1/1951  1.4782609
358 10/1/1979  5.7765957
426  6/1/1985  3.3011905
763  7/1/2013  2.7233333
616  4/1/2001  5.2951049
242  2/1/1970  1.3062500
451  7/1/1987  2.1624242
57   9/1/1954  1.5952381
406 10/1/1983  3.1384615
373  1/1/1981  0.1000000
496  4/1/1991  4.0793269
32   8/1/1952  8.7687500
243  3/1/1970  3.4320000
177  9/1/1964  4.5520000
163  7/1/1963  2.0032258
407 11/1/1983  2.5166667
741  9/1/2011  1.9750943
408 12/1/1983  3.7327586
679  7/1/2006  1.5416667
550 10/1/1995  1.3891892
84  12/1/1956 20.4000000
99   3/1/1958  2.5066667
221  5/1/1968  4.5678082
505  1/1/1992  0.7066667
749  5/1/2012  1.7117355
59  11/1/1954  1.0500000
747  3/1/2012  6.3209036
716  8/1/2009  3.2708197
617  5/1/2001  1.5666667
20   8/1/1951  4.4888889
271  7/1/1972  3.2339130
73   1/1/1956 11.5500000
121  1/1/1960  1.7111111
797  5/1/2016  2.4201826
554  2/1/1996  8.5428571
694 10/1/2007  3.6082558
366  6/1/1980  3.1803653
484  4/1/1990  2.9287037
567  3/1/1997  5.4343137
798  6/1/2016  2.1829070
315  3/1/1976  8.0566845
655  7/1/2004  1.3506349
39   3/1/1953 23.1590909
230  2/1/1969  0.2800000
621  9/1/2001  2.8837209
755 11/1/2012  2.4557143
503 11/1/1991  2.3850000
314  2/1/1976  7.4973684
643  7/1/2003  2.2384615
379  7/1/1981  1.2760000
605  5/1/2000  1.7112033
291  3/1/1974 13.1365854
319  7/1/1976  1.3654762
725  5/1/2010  3.9333333
283  7/1/1973  1.3787500
134  2/1/1961  5.7968750
327  3/1/1977  5.5187500
368  8/1/1980  3.7800000
95  11/1/1957  8.7152542
521  5/1/1993  3.8554945
119 11/1/1959  5.2545455
284  8/1/1973  1.8641509
17   5/1/1951  2.2526316
76   4/1/1956 15.4565217
556  4/1/1996  2.6675978
367  7/1/1980  1.8505263
341  5/1/1978  3.6870968
520  4/1/1993  2.7694118
690  6/1/2007  1.7360465
475  7/1/1989  1.9101695
530  2/1/1994  1.3555556
452  8/1/1987  0.6126984
592  4/1/1999  5.2060440
180 12/1/1964  7.7800000
458  2/1/1988  0.6500000
683 11/1/2006  5.3020455
317  5/1/1976  2.3522293
721  1/1/2010  3.8668750
223  7/1/1968  0.8732143
557  5/1/1996  2.6464135
248  8/1/1970  1.2636364
8    8/1/1950  3.2538462
535  7/1/1994  1.6748387
340  4/1/1978  5.8157407
229  1/1/1969 29.5000000
215 11/1/1967  3.8750000
753  9/1/2012  1.1676923
794  2/1/2016  4.7563810
760  4/1/2013  3.9434091
260  8/1/1971  1.4460000
719 11/1/2009  1.1700000
488  8/1/1990  2.1100000
68   8/1/1955  2.3454545
537  9/1/1994  0.5300000
699  3/1/2008  4.4703053
464  8/1/1988  1.9262295
664  4/1/2005  2.8984848
692  8/1/2007  2.5000000
761  5/1/2013  2.7301075
261  9/1/1971  4.6212766
516 12/1/1992  1.3550000
789  9/1/2015  3.1441176
738  6/1/2011  2.5268125
653  5/1/2004  2.2884766
433  1/1/1986  2.7246470
372 12/1/1980  4.1000000
419 11/1/1984  3.5200000
14   2/1/1951 14.7909091
711  3/1/2009  2.7964103
157  1/1/1963  9.6687500
651  3/1/2004  2.8640000
166 10/1/1963  1.4076923
691  7/1/2007  1.0904348
595  7/1/1999  2.0000000
579  3/1/1998  3.1876712
432 12/1/1985 10.1666667
244  4/1/1970  9.6417323
226 10/1/1968  1.1928571
326  2/1/1977  4.2176471
9    9/1/1950  9.8000000
517  1/1/1993  0.6235294
695 11/1/2007  1.8000000
289  1/1/1974  3.4041667
542  2/1/1995  4.9571429
414  6/1/1984  4.5971660
501  9/1/1991  0.8961538
500  8/1/1991  1.0304348
311 11/1/1975  3.7641026
750  6/1/2012  2.1621622
481  1/1/1990  2.2545455
5    5/1/1950  4.2131148
45   9/1/1953  1.2000000
12  12/1/1950 13.5500000
96  12/1/1957  5.8552632
199  7/1/1966  1.7225490
321  9/1/1976  1.4257143
24  12/1/1951  2.8400000
192 12/1/1965  0.8000000
523  7/1/1993  1.2115702
133  1/1/1961  1.5000000
513  9/1/1992  1.8253012
447  3/1/1987  3.1789474
301  1/1/1975 11.0818182
217  1/1/1968  2.5000000
422  2/1/1985  1.8571429
256  4/1/1971  5.3106667
324 12/1/1976  0.3000000
572  8/1/1997  0.7880952
646 10/1/2003  1.3961538
28   4/1/1952  4.7351351
580  4/1/1998  4.2175824
457  1/1/1988  7.3058824
245  5/1/1970  3.2681818
85   1/1/1957  6.5166667
246  6/1/1970  3.5036232
582  6/1/1998  2.7438642
473  5/1/1989  2.9184874
338  2/1/1978  1.0000000
661  1/1/2005  3.6515152
296  8/1/1974  1.4869159
724  4/1/2010  6.6195270
784  4/1/2015  3.4124719
599 11/1/1999  2.9777778
487  7/1/1990  1.4103774
259  7/1/1971  2.9770000
> test.data
         date  avglength
313  1/1/1976  0.4916667
782  2/1/2015  0.6333333
800  8/1/2016  2.3550000
602  2/1/2000  4.4758621
38   2/1/1953  5.2437500
111  3/1/1959  4.7644444
342  6/1/1978  1.7560000
628  4/1/2002  4.5815126
645  9/1/2003  1.4593750
601  1/1/2000  6.6500000
174  6/1/1964  3.6302158
276 12/1/1972  8.2500000
47  11/1/1953  2.6583333
238 10/1/1969  3.7692308
109  1/1/1959 10.8437500
164  8/1/1963  2.9692308
449  5/1/1987  2.0214286
60  12/1/1954 15.0000000
718 10/1/2009  3.6269231
630  6/1/2002  1.5041237
681  9/1/2006  3.7000000
678  6/1/2006  1.2641667
225  9/1/1968  3.3600000
459  3/1/1988  1.7285714
390  6/1/1982  2.1398990
485  5/1/1990  2.2452675
356  8/1/1979  1.7444444
626  2/1/2002  0.4500000
211  7/1/1967  2.3166667
213  9/1/1967  1.0129496
444 12/1/1986  1.0000000
625  1/1/2002  4.2666667
393  9/1/1982  2.3026316
652  4/1/2004  2.9256000
145  1/1/1962  1.8250000
726  6/1/2010  2.7900923
381  9/1/1981  0.6115385
548  8/1/1995  0.5811321
409  1/1/1984  0.1000000
717  9/1/2009  2.1125000
120 12/1/1959  3.5500000
465  9/1/1988  1.4657895
266  2/1/1972  0.8285714
470  2/1/1989  4.0055556
23  11/1/1951  5.1666667
198  6/1/1966  3.0928571
569  5/1/1997  1.6666667
568  4/1/1997  2.3175439
22  10/1/1951  1.0500000
620  8/1/2001  1.0710145
427  7/1/1985  1.9098039
735  3/1/2011  2.7732000
591  3/1/1999  4.3410714
758  2/1/2013  2.4410256
378  6/1/1981  2.1242152
799  7/1/2016  2.2605357
200  8/1/1966  2.2366667
780 12/1/2014  2.4270000
212  8/1/1967  1.0285714
202 10/1/1966  4.9965517
453  9/1/1987  1.3578947
440  8/1/1986  1.8028169
58  10/1/1954  4.4500000
762  6/1/2013  2.3952419
74   2/1/1956  8.5448980
1    1/1/1950  3.3777778
277  1/1/1973  7.5393939
142 10/1/1961  1.1642857
210  6/1/1967  5.2402844
442 10/1/1986  4.3857143
489  9/1/1990  3.3377778
682 10/1/2006  1.2086842
178 10/1/1964  6.1681818
339  3/1/1978  0.7823529
172  4/1/1964  4.3561728
51   3/1/1954  6.3234375
258  6/1/1971  3.2015075
252 12/1/1970  5.6214286
578  2/1/1998  2.7708333
46  10/1/1953  3.2666667
27   3/1/1952 11.2088889
396 12/1/1982  7.5370000
144 12/1/1961  3.7375000
640  4/1/2003  3.1839506
385  1/1/1982  2.7111111
275 11/1/1972  2.8117647
425  5/1/1985  6.5168367
354  6/1/1979  2.6846667
686  2/1/2007  6.7787037
107 11/1/1958  6.7644444
533  5/1/1994  0.7956522
81   9/1/1956  5.5937500
42   6/1/1953  9.4285714
776  8/1/2014  1.3069697
33   9/1/1952  1.0000000
98   2/1/1958 16.8347826
648 12/1/2003  1.0000000
416  8/1/1984  0.5765957
450  6/1/1987  1.0113636
21   9/1/1951  7.3888889
62   2/1/1955  3.6000000
146  2/1/1962  1.7960000
383 11/1/1981  1.4285714
498  6/1/1991  0.8319444
394 10/1/1982  1.0222222
649  1/1/2004  0.8333333
207  3/1/1967  2.9666667
71  11/1/1955  6.5954545
672 12/1/2005  1.4269231
318  6/1/1976  2.3568047
193  1/1/1966  0.1000000
168 12/1/1963  5.0285714
493  1/1/1991  0.8793103
687  3/1/2007  5.4676667
357  9/1/1979  1.2333333
138  6/1/1961  4.5842593
502 10/1/1991  2.4565217
791 11/1/2015  6.7611429
64   4/1/1955  7.5870000
792 12/1/2015  6.4432184
783  3/1/2015  2.8900000
310 10/1/1975  2.2333333
303  3/1/1975  4.9523256
389  5/1/1982  2.6573574
430 10/1/1985  3.0000000
220  4/1/1968  7.0857143
511  7/1/1992  1.4455814
495  3/1/1991  5.5459627
479 11/1/1989  2.9728814
538 10/1/1994  1.0039216
371 11/1/1980  0.2333333
710  2/1/2009  6.0247368
600 12/1/1999  4.3933333
577  1/1/1998  1.8638298
803 11/1/2016  5.4050980
156 12/1/1962  0.2500000
294  6/1/1974  3.4092784
606  6/1/2000  1.7794118
565  1/1/1997  2.7460000
570  6/1/1997  1.0589744
349  1/1/1979  2.2750000
328  4/1/1977  3.2340909
603  3/1/2000  1.9009709
428  8/1/1985  2.8854545
369  9/1/1980  1.9783784
249  9/1/1970  3.0196429
375  3/1/1981  4.4828571
476  8/1/1989  1.1583333
666  6/1/2005  1.8820189
239 11/1/1969  1.5000000
323 11/1/1976  3.9101415
693  9/1/2007  2.0867308
604  4/1/2000  4.5029412
329  5/1/1977  4.0099567
415  7/1/1984  2.0458333
527 11/1/1993  1.8473684
154 10/1/1962  1.7545455
766 10/1/2013  4.1280000
188  8/1/1965  1.6311475
545  5/1/1995  3.5215000
609  9/1/2000  3.1851064
> Box.test(coredata(loglen),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(loglen)
X-squared = 4.2914, df = 6, p-value = 0.6373

> #apply differencing
> 
> tornavglentsdiff=diff(tornavglents)
Error in diff(tornavglents) : object 'tornavglents' not found
> tornlentsdiff=diff(tornlents)
> Box.test(coredata(tornlentsdiff),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(tornlentsdiff)
X-squared = 164.58, df = 6, p-value < 2.2e-16

> qqnorm(coredata(tornlentsdiff)
+ )
> qqline(coredata(tornlentsdiff),col=3)
> 
> 
> #jarque Bera test
> 
> jarque.bera.test(coredata(tornlentsdiff))

        Jarque Bera Test

data:  coredata(tornlentsdiff)
X-squared = 1244.4, df = 2, p-value < 2.2e-16

> #histogram
> 
> 
> hist(tornlentsdiff,xlab="Average tornado diff length",prob=TRUE,main="Histogram of tornado diff length over years")
> xfit<-seq(min(tornlentsdiff),max(tornlentsdiff),length=40)
> yfit<-dnorm(xfit,mean=mean(tornlentsdiff),sd=sd(tornlentsdiff))
> lines(xfit,yfit,col='green',lwd=2)
> 
> 
> #acf and pacf plots for the differenced data
> 
> #time plots for the differenced data
> 
> plot(tornlentsdiff,main="Differenced length over years")
> 
> 
> #acf plot
> 
> acf(coredata(tornlentsdiff),plot=F,lag=20,na.action=na.pass)

Autocorrelations of series ‘coredata(tornlentsdiff)’, by lag

     0      1      2      3      4      5      6      7      8      9     10     11     12 
 1.000 -0.503 -0.015  0.035 -0.019  0.001  0.012 -0.056  0.034  0.054 -0.062  0.029  0.015 
    13     14     15     16     17     18     19     20 
-0.053  0.043 -0.033  0.019  0.019 -0.036 -0.037  0.069 
> acf(coredata(tornlentsdiff),plot=T,lag=20,na.action=na.pass)
> pacf(coredata(tornlentsdiff),plot=F,lag=20,na.action=na.pass)

Partial autocorrelations of series ‘coredata(tornlentsdiff)’, by lag

     1      2      3      4      5      6      7      8      9     10     11     12     13 
-0.503 -0.359 -0.240 -0.197 -0.167 -0.125 -0.190 -0.186 -0.086 -0.107 -0.076 -0.024 -0.071 
    14     15     16     17     18     19     20 
-0.038 -0.067 -0.044 -0.004 -0.030 -0.127 -0.102 
> pacf(coredata(tornlentsdiff),plot=T,lag=20,na.action=na.pass)
> #Ljung box test
> 
> Box.test(coredata(tornlentsdiff),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(tornlentsdiff)
X-squared = 164.58, df = 6, p-value < 2.2e-16

> Box.test(coredata(tornlentsdiff),lag=12,type='Ljung')

        Box-Ljung test

data:  coredata(tornlentsdiff)
X-squared = 172.45, df = 12, p-value < 2.2e-16

> Box.test(coredata(tornlentsdiff),lag=18,type='Ljung')

        Box-Ljung test

data:  coredata(tornlentsdiff)
X-squared = 177.6, df = 18, p-value < 2.2e-16

> 
> 
> #Build models 
> 
> #acf cuts off at lag q. Here q = 1. Building AR(1) model
> 
> modelAR1 = arima(tornlentsdiff,c(1,0,0))
> modelAR1

Call:
arima(x = tornlentsdiff, order = c(1, 0, 0))

Coefficients:
          ar1  intercept
      -0.5031     0.0013
s.e.   0.0341     0.1079

sigma^2 estimated as 16.86:  log likelihood = -1817.84,  aic = 3641.68
> 
> 
> #pacf cuts off at lag p. here p=10. Building MA(10) model
> 
> modelMA10=arima(tornlentsdiff,c(0,0,10))
> modelMA10

Call:
arima(x = tornlentsdiff, order = c(0, 0, 10))

Coefficients:
          ma1     ma2     ma3      ma4      ma5      ma6      ma7     ma8     ma9     ma10
      -1.0511  0.0134  0.0366  -0.0232  -0.0023  -0.0001  -0.0154  0.0908  0.0268  -0.0754
s.e.   0.0397  0.0571  0.0570   0.0571   0.0579   0.0582   0.0548  0.0563  0.0574   0.0414
      intercept
          0e+00
s.e.      6e-04

sigma^2 estimated as 10.61:  log likelihood = -1672.46,  aic = 3368.91
> #residual analysis of modelAR1
> 
> AR1residuals=modelAR1$residuals
> tsdiag(modelAR1)
> MA10residuals=modelMA10$residuals
> tsdiag(modelMA10)
> 
> 
> #qqplot of residuals
> 
> qqnorm(AR1residuals)
> qqline(AR1residuals,col=2)
> 
> 
> qqnorm(MA10residuals)
> qqline(MA10residuals,col=3)
> 
> 
> #white noise test for residuals
> 
> Box.test(AR1residuals,lag=6,type='Ljung')

        Box-Ljung test

data:  AR1residuals
X-squared = 97.164, df = 6, p-value < 2.2e-16

> Box.test(AR1residuals,lag=12,type='Ljung')

        Box-Ljung test

data:  AR1residuals
X-squared = 106.8, df = 12, p-value < 2.2e-16

> Box.test(AR1residuals,lag=3,type='Ljung')

        Box-Ljung test

data:  AR1residuals
X-squared = 96.944, df = 3, p-value < 2.2e-16

> Box.test(MA10residuals,lag=3,type='Ljung')

        Box-Ljung test

data:  MA10residuals
X-squared = 0.0034366, df = 3, p-value = 0.9999

> Box.test(MA10residuals,lag=6,type='Ljung')

        Box-Ljung test

data:  MA10residuals
X-squared = 0.021641, df = 6, p-value = 1

> Box.test(MA10residuals,lag=12,type='Ljung')

        Box-Ljung test

data:  MA10residuals
X-squared = 0.34744, df = 12, p-value = 1

> #Hence MA(10) model is a better model than AR(1) model in terms of AIC 
> #the residuals of MA(10) model are also white noise unlike those of AR(1) model
> 
> #building ARMA model
> 
> source("E:\\MITM\\Fall 2017\\ITMD527\\HW\\EACF.R")
> 
> 
> #building the eacf matrix to identify the best p and q values for ARMA model
> 
> EACF(tornlentsdiff)
[1] "EACF table"
      [,1]   [,2]   [,3]   [,4]     [,5]     [,6]
[1,] -0.50 -0.015  0.035 -0.019  0.00072  0.01247
[2,] -0.52 -0.290  0.036 -0.019  0.00140  0.00095
[3,] -0.48 -0.350 -0.262  0.016 -0.00458 -0.00269
[4,] -0.50 -0.036 -0.334 -0.031 -0.00613 -0.01219
[5,] -0.50  0.052 -0.035  0.063 -0.25020 -0.00989
[6,] -0.49 -0.121 -0.058  0.125 -0.22334 -0.02937
[1] " "
[1] "Simplified EACF: 2 denotes significance"
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    2    0    0    0    0    0
[2,]    2    2    0    0    0    0
[3,]    2    2    2    0    0    0
[4,]    2    0    2    0    0    0
[5,]    2    0    0    0    2    0
[6,]    2    2    0    2    2    0
> 
> 
> #the top left zero is at (1,2) position and hence p=1 and q=2
> 
> #building ARMA(1,2) model
> 
> modelARMA12=arma(tornlentsdiff,order=c(1,2))
> modelARMA12

Call:
arma(x = tornlentsdiff, order = c(1, 2))

Coefficient(s):
      ar1        ma1        ma2  intercept  
-0.858901  -0.132337  -0.847293   0.001647  

> summary(modelARMA12)

Call:
arma(x = tornlentsdiff, order = c(1, 2))

Model:
ARMA(1,2)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7983 -1.9907 -0.7753  1.1537 27.2031 

Coefficient(s):
           Estimate  Std. Error  t value Pr(>|t|)    
ar1       -0.858901    0.119563   -7.184 6.79e-13 ***
ma1       -0.132337    0.121071   -1.093    0.274    
ma2       -0.847293    0.122912   -6.893 5.44e-12 ***
intercept  0.001647    0.003082    0.535    0.593    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Fit:
sigma^2 estimated as 11,  Conditional Sum-of-Squares = 7035.23,  AIC = 3369.52

> modelAR1

Call:
arima(x = tornlentsdiff, order = c(1, 0, 0))

Coefficients:
          ar1  intercept
      -0.5031     0.0013
s.e.   0.0341     0.1079

sigma^2 estimated as 16.86:  log likelihood = -1817.84,  aic = 3641.68
> modelMA10

Call:
arima(x = tornlentsdiff, order = c(0, 0, 10))

Coefficients:
          ma1     ma2     ma3      ma4      ma5      ma6      ma7     ma8     ma9     ma10
      -1.0511  0.0134  0.0366  -0.0232  -0.0023  -0.0001  -0.0154  0.0908  0.0268  -0.0754
s.e.   0.0397  0.0571  0.0570   0.0571   0.0579   0.0582   0.0548  0.0563  0.0574   0.0414
      intercept
          0e+00
s.e.      6e-04

sigma^2 estimated as 10.61:  log likelihood = -1672.46,  aic = 3368.91
> 
> 
> #residual analysis fo ARMA12 model
> 
> armaresiduals=modelARMA12$residuals
> tsdiag(modelARMA12)
Error in UseMethod("tsdiag") : 
  no applicable method for 'tsdiag' applied to an object of class "arma"
> plot(armaresiduals,type='l')
> 
> 
> #qq plot of arma residuals
> qqnorm(armaresiduals)
> qqline(armaresiduals,col=2)
> 
> 
> #jarque Bera test for residuals
> 
> 
> jarque.bera.test(armaresiduals)
Error in jarque.bera.test(armaresiduals) : NAs in x
> jarque.bera.test(ma10residuals)
Error in NCOL(x) : object 'ma10residuals' not found
> jarque.bera.test(MA10residuals)

        Jarque Bera Test

data:  MA10residuals
X-squared = 7054.2, df = 2, p-value < 2.2e-16

> armaresiduals
             Jan         Feb         Mar         Apr         May         Jun         Jul
1950                      NA          NA  0.06725356  0.83481314  2.12700997  0.67209030
1951 -1.77165057 -1.36831661 -0.59377751 -2.92228015 -1.06065870  1.25065321  4.95274869
1952  0.59127046 -1.44423130  9.02717408 -2.84239807 -0.63459399 27.20306242  1.19049587
1953 -0.76642918  7.08808671 -2.20343207 -1.50385130 -1.70055524 -1.62130670 -0.14267147
1954 -1.16118421  1.87298422 -2.90729981  0.32895526 -0.33923676 -1.90740099  3.64910272
1955  7.38828646 -1.90707403 -0.69086005  2.10048278 -1.91761142 -1.52979095 -1.82857761
1956  1.86072691  1.28964047 -2.60997616  7.84241829 -1.82117815 -0.41067430 -1.12605894
1957  2.26333929 -0.81966144  1.47328975  0.27690003 -2.19191920 -0.76872950  3.59369387
1958 -1.01646127 -2.12271746 -1.94028128  0.52676235  5.99768881 -1.78344036  2.71456290
1959 -1.55747211  9.83991627  0.29688908 -0.41437862  1.54068054  3.92520569 -2.67395335
1960 -1.34034847 -0.51218195  1.65224370 -1.41663635 -0.93811790 -0.25556770  0.33259858
1961  1.25929842  0.12066077  1.42729159 -1.05931236  2.79355610 -1.32150020  9.49213694
1962  1.88659059 -1.83746997  1.77007384 -2.14201819 -2.44902804 -0.59929963  4.27319295
1963 -2.74182917 -1.59098992  0.48842371 -2.62619019 -3.06125814  5.13882603 -2.57539192
1964 -3.43750348 -1.70023877  0.38479346  2.55402818 -0.67460901  0.16514641 -2.94710128
1965 -2.21109255  0.73884237 -3.54380174 -1.38133446 -2.26836947 -0.24617844 -2.11564382
1966 -0.58644164 -1.65566495  2.35129945 -1.65919137  8.26060584 -1.86025047 -0.78558229
1967  1.52976189  0.58531807 -0.93995792 -3.00407676  5.94044453  1.22291553 -2.57894087
1968  1.07734399  1.56201317 -0.12975839 -0.86603965 -0.88353337 -1.05082419 -2.52294570
1969 -1.65395003  1.04985385 -0.20819077  2.73983942 -1.30970398  2.85500506 -2.58588019
1970  1.28880799  0.14040368 -2.39067396 -2.11302770 -0.76407083 -1.62824029  0.98334930
1971 -1.13909976 -0.68921443  5.21814701 -1.59702069 -2.05528143 -2.63937152  0.90790042
1972 -3.11618416  0.69104062  5.44247550  0.37755534 -0.50260573  1.48709826 -2.23400058
1973 -1.54748053 -0.78342178 -2.52634924 -1.06406462 -1.60775417 -2.01291363 -2.42514172
1974 -1.93956074  6.04667285 -0.19841787 -2.64444355  2.87073181 -2.46061606 -3.20945450
1975 -1.46053920 -0.61001817 -1.97271578  4.10045292 -0.82619545  3.61942163  4.10644350
1976 -1.35095770 -3.21021907 -1.79542384  3.17804643  1.02215082 -2.56604609 -0.96467981
1977  7.56397891  9.06451245  1.07766793  2.89484797 -2.00104274  0.63138626 -1.08906462
1978  5.08646780 -1.29124981  5.87717316  5.22423095 -0.11809454 -2.53959437  2.51734046
1979 -2.71396778  3.77315174  0.34863868 -2.06613143  2.63064661 -0.60995488 -0.76688226
1980 -2.54618546 -2.50231410  0.18697332 -0.25861415  6.96686244 -1.62763599  3.08219379
1981 -3.17019732 -0.15767540  0.04571636 -2.29014856 -0.87874376 -2.85487885  3.02878363
1982 -2.66396056  2.08026783  6.81577557  0.40727456 -0.62406884 -2.78676378 12.86951710
1983  9.00135007 -2.81067009  1.74814260 -3.13656895  7.48342527  0.17800560 -2.31919176
1984  1.92602099  0.05504120 -0.98321418 -2.90489903 -2.02930743 -1.67770533 -2.81093971
1985  2.14184428 -3.19276160 -2.62576434  1.99608861 -2.52918519 -0.28925117  1.91067404
1986 -1.93797138 -0.47500325 -1.86874334 -1.62801480 -0.64336331 -1.22145499 -2.44358948
1987 -2.72248541 -1.08333206 -1.06226287  2.07625949  0.81606574  8.67350343  1.41214361
1988 -0.06067788  1.06403644  0.49267370 11.22911085 -2.71877513 -1.41672675 -0.44815147
1989  0.65296722  3.94557875 -0.59429348  1.53342861 -1.80555522  1.84144735 -2.59377508
1990 -0.56912365 -1.17883431  1.43558471 -2.59044220 -1.69795502 -2.25302893 -0.68240389
1991 -1.82947151 -1.31179154 -1.82592074 -0.06224778 -2.23840657 -2.38502146 16.66598912
1992  2.46748438 -0.55842497 -2.30873955  0.67819570 -0.61315142  7.73002722 -2.19439325
1993  1.52230134 -1.73660833  4.13951113 -2.58630973 19.21208917 -3.79833011 -1.27319858
1994 -2.34744730  9.13301211 -2.73982649 -0.16825404 -2.69439657  1.72321538  1.46006195
1995 -1.88534406 11.35026630 -1.54511812 -2.39061799 -0.49239413 -1.43261497 -2.43000274
1996 -3.45563581  1.21239039 -1.72330795 -0.22140934 -3.18382409 -1.40864172 -2.74546756
1997 -3.12788620  0.55365565 -0.30925685 -2.76913663 -3.05116409 -2.04875407 -1.81518004
1998 -1.32663965  0.59926422 -2.68834434 -0.86595258 -1.47468919 -1.69905812 -1.24452499
1999 -1.22461711 -2.73343712 -2.96907219 -2.07351328 -0.82282451  6.13167768  5.58195724
2000 -0.70321253  0.83234069  0.48655094 -3.24221947 -3.06298322 -0.30509926 -1.89125666
2001 -2.41380784 -2.65907872 -1.23940860 -3.24395297 -2.82167102 -2.48170755 -2.14781558
2002 -3.69707129 -3.16170900 -2.52527460  0.84651687  0.32103302  3.40185783 -0.66460454
2003 -0.25283491 -2.41834375  2.73752640 -0.48706722 -0.93585553 -2.47894360 -0.90226530
             Aug         Sep         Oct         Nov         Dec
1950  1.87081947 -0.29733735  0.88642023 10.25496127 -1.46443770
1951 -1.54334895 -0.73844328  1.82624268  8.64977080 -0.12941763
1952 -0.04776796 -1.37189361 -1.75705888 -2.14431546 -0.48109718
1953  5.91522351 -1.60138022 -2.17237669  2.15799653 -0.34028452
1954 -1.99761059 -0.10919785  4.41522168  0.90251325  1.52049847
1955 -1.10956636  1.57919064 -1.10209429 -0.05065077  0.66121473
1956 -0.51047029  3.14237741 -2.03467147 -1.70041879  2.96941308
1957 -1.98168284 -3.01934899 -1.69815527  1.05463917  7.73528700
1958  3.40195483  0.76003800 -1.03994703 -2.30373286  0.06108750
1959  3.92761191  2.30519950  5.14478832  7.22938469 -1.73034637
1960 -2.61850906 -0.73824315 -0.44699500 -1.14857474 -3.28572117
1961 -1.48687795 -0.78195246  2.70160490 -1.19383047 -0.56570890
1962 -0.49925572  4.84180269 -1.07654339 -2.20449756 -2.39101185
1963 -0.75741057 -1.12233191 -1.84936236 -1.84545688  1.86402108
1964  2.14395791  0.24968596  2.76162240 -1.90524719  4.83565535
1965  0.76876580 -2.07084836 -2.72790265 -2.76515711 -1.60215906
1966  2.60221183 -2.62198724 -1.70551673  1.25632801  0.75999363
1967 -0.75991190 -1.76474060 -1.23413793 -2.61536138 -1.36926990
1968 -1.29722750  6.44929148 -0.39458923 -1.95667972 -2.82912939
1969 -1.51854772 -1.15266450 -2.76028078 -0.85160261  1.58316279
1970  1.39386398 -1.26033715  1.30846493 -0.16528633 -1.76702864
1971 -2.66815801 -2.14360179 -2.30472302 -2.22303898 -0.20072612
1972  2.04179452 -0.01978880  1.72883302  3.75063756 -0.06119853
1973  1.58263830 -1.46576702 -3.21020484  2.02948970  4.97874971
1974  1.60007901 -2.04251986  1.90779703  2.24734930 -0.16355602
1975 -1.35355239  1.89011130 -2.36729526 -1.78806154  0.35013269
1976  7.44835758  0.45501027 -1.16878178 -3.16339319 -1.64813331
1977 -2.20887441  1.23097452  0.12140778 -1.79442199  1.69312340
1978 -2.39843537 -2.51391009  3.28223290 -0.19658838 -2.11495192
1979 -2.26975412 -1.40050282 -2.08845985  1.01538540 -0.91363271
1980 -2.38784687 -1.13174987 -2.73601382  0.15949218  3.03563721
1981  0.81625985  0.27324207 -1.88433941 -1.95558313 -2.59743854
1982  5.83578369 -1.82814128 -0.67218063 -3.27208994  2.32773034
1983 -1.99508784 -1.59087165  0.84292941  4.02006306 -1.05301623
1984  1.12900546 -2.00662857 -0.04865214 -0.07643863 -2.33099335
1985 -2.13908919 -1.35151926  0.36613287 -2.58263920 -0.38191093
1986  1.16521339 -0.80648917 -1.55896094 -0.12717971 -1.98918803
1987  0.77076031  0.52479375  1.90759360 -0.88566146 -2.91706973
1988 -1.64130774 -0.10055162  0.02676196 -2.74407087 -1.41225962
1989 -0.06143747 -1.61363827 -1.08584954 -2.40075943  1.89086316
1990 -3.71391462  0.29825881  4.99832178 -0.39647337  0.71718557
1991 -1.38186522  0.62898955 -3.18007822 -2.20081985 -2.78583428
1992 -1.48401155  4.67436696 -0.31627918 -0.74917092 -0.98794847
1993 -1.58010343 -1.72785448  3.48251589 -1.87266958 -2.77810246
1994 -0.32599192  4.63415160 -0.28545457  1.11205712 -2.28509328
1995 -2.25050553 -2.76345478 -3.49340622  1.14989672  3.70977405
1996 -0.75596416 -2.29751783  1.83847472 25.53586458 -0.34715526
1997 -3.59097894  0.36615524 -2.15554512 -1.18951854 -1.54885558
1998  0.14403708 -0.43577078 10.83547212 -1.25084585  5.58388749
1999 -2.96736645  0.10325455  5.67813736 -3.54451671 -2.36488269
2000 -1.79396341  0.19641499 -2.82656406  9.55274803  1.78029552
2001 -0.75556701  7.14405394 -1.49044774 -2.15957391  1.35108948
2002  2.57326966 -0.44714053 -1.22817332 -1.02097330 -2.94588523
2003                                                            
> jarque.bera.test(na.omit(armaresiduals))

        Jarque Bera Test

data:  na.omit(armaresiduals)
X-squared = 6920.3, df = 2, p-value < 2.2e-16

> jarque.bera.test(MA10residuals)

        Jarque Bera Test

data:  MA10residuals
X-squared = 7054.2, df = 2, p-value < 2.2e-16

> jarque.bera.test(AR1residuals)

        Jarque Bera Test

data:  AR1residuals
X-squared = 1780.6, df = 2, p-value < 2.2e-16

> #ljung box test to test white noise for arma residuals
> 
> 
> Box.test(na.omit(armaresiduals),lag=6,type='Ljung')

        Box-Ljung test

data:  na.omit(armaresiduals)
X-squared = 3.0248, df = 6, p-value = 0.8057

> Box.test(na.omit(armaresiduals),lag=12,type='Ljung')

        Box-Ljung test

data:  na.omit(armaresiduals)
X-squared = 10.312, df = 12, p-value = 0.5886

> #auto.arima 
> 
> #correcting and building right models
> 
> 
> #AR(p) model --> p = 10 from pacf plot ; so AR(10)
> 
> modelAR10 = arima(tornlentsdiff,c(10,0,0))
> modelAR10

Call:
arima(x = tornlentsdiff, order = c(10, 0, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540
         ar10  intercept
      -0.1151    -0.0003
s.e.   0.0393     0.0196

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3417.97
> 
> #MA(q) model --> q = 1 from acf plot; hence MA(1) model
> 
> 
> modelMA1 = arima(tornlentsdiff,c(0,0,1))
> modelMA1

Call:
arima(x = tornlentsdiff, order = c(0, 0, 1))

Coefficients:
          ma1  intercept
      -1.0000      0e+00
s.e.   0.0047      7e-04

sigma^2 estimated as 10.79:  log likelihood = -1677.63,  aic = 3361.26
> #residual analysis of models
> ar10residuals=modelAR10$residuals
> ma1residuals=modelMA1$residuals
> tsdiag(modelAR10)
> tsdiag(modelMA1)
> 
> 
> #qqplots
> qqnorm(coredata(ar10residuals))
> qqline(coredata(ar10residuals),col=2)
> qqnorm(coredata(ma1residuals))
> qqline(coredata(ma1residuals),col=1)
> 
> 
> #jarque Bera test
> jarque.bera.test(coredata(ar10residuals))

        Jarque Bera Test

data:  coredata(ar10residuals)
X-squared = 4815.2, df = 2, p-value < 2.2e-16

> jarque.bera.test(coredata(ma1residuals))

        Jarque Bera Test

data:  coredata(ma1residuals)
X-squared = 6741.3, df = 2, p-value < 2.2e-16

> 
> 
> #white noise test for residuals
> 
> Box.test(coredata(ar10residuals),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(ar10residuals)
X-squared = 3.1761, df = 6, p-value = 0.7864

> Box.test(coredata(ar10residuals),lag=12,type='Ljung')

        Box-Ljung test

data:  coredata(ar10residuals)
X-squared = 15.042, df = 12, p-value = 0.2392

> Box.test(coredata(ma1residuals),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(ma1residuals)
X-squared = 4.0533, df = 6, p-value = 0.6695

> jarque.bera.test(coredata(armaresiduals))
Error in jarque.bera.test(coredata(armaresiduals)) : NAs in x
> jarque.bera.test(na.omit(armaresiduals))

        Jarque Bera Test

data:  na.omit(armaresiduals)
X-squared = 6920.3, df = 2, p-value < 2.2e-16

> modelAR10

Call:
arima(x = tornlentsdiff, order = c(10, 0, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540
         ar10  intercept
      -0.1151    -0.0003
s.e.   0.0393     0.0196

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3417.97
> modelMA1

Call:
arima(x = tornlentsdiff, order = c(0, 0, 1))

Coefficients:
          ma1  intercept
      -1.0000      0e+00
s.e.   0.0047      7e-04

sigma^2 estimated as 10.79:  log likelihood = -1677.63,  aic = 3361.26
> 
> 
> #try auto.arima model
> 
> auto.arima(coredata(tornlentsdiff)
+ )
Error in auto.arima(coredata(tornlentsdiff)) : 
  could not find function "auto.arima"
> library(forecast)
Warning message:
package ‘forecast’ was built under R version 3.4.2 
> auto.arima(coredata(tornlentsdiff))
Series: coredata(tornlentsdiff) 
ARIMA(1,0,0) with non-zero mean 

Coefficients:
          ar1    mean
      -0.5031  0.0013
s.e.   0.0341  0.1079

sigma^2 estimated as 16.91:  log likelihood=-1817.84
AIC=3641.68   AICc=3641.72   BIC=3655.07
> auto.arima(tornlents,c(10,1,1))
Error in results[1, ] <- c(p, d, q, P, D, Q, constant, bestfit$ic) : 
  number of items to replace is not a multiple of replacement length
In addition: Warning messages:
1: In if (is.na(d)) { :
  the condition has length > 1 and only the first element will be used
2: In if (D + d > 2) warning("Having 3 or more differencing operations is not recommended. Please consider reducing the total number of differences.") :
  the condition has length > 1 and only the first element will be used
3: In auto.arima(tornlents, c(10, 1, 1)) :
  Having 3 or more differencing operations is not recommended. Please consider reducing the total number of differences.
4: In if (d > 0) dx <- diff(dx, differences = d, lag = 1) :
  the condition has length > 1 and only the first element will be used
5: In if (lag < 1 | differences < 1) stop("bad value for 'lag' or 'differences'") :
  the condition has length > 1 and only the first element will be used
6: In if (lag * differences >= NROW(x)) return(x[0L]) :
  the condition has length > 1 and only the first element will be used
7: In 1L:differences :
  numerical expression has 3 elements: only the first used
8: In if (diffs == 1 & constant) { :
  the condition has length > 1 and only the first element will be used
> auto.arims(tornlents,d=1)
Error in auto.arims(tornlents, d = 1) : 
  could not find function "auto.arims"
> auto.arima(tornlents,d=1)
Series: tornlents 
ARIMA(1,1,0)(1,0,0)[12] with drift 

Coefficients:
          ar1    sar1   drift
      -0.5030  0.0100  0.0013
s.e.   0.0341  0.0395  0.1089

sigma^2 estimated as 16.93:  log likelihood=-1817.81
AIC=3643.62   AICc=3643.68   BIC=3661.48
> 
> 
> #undifferencing the data
> 
> tornlentsundiff=diffinv(tornlentsdiff)
> tornlentsundiff
            Jan        Feb        Mar        Apr        May        Jun        Jul
1950  0.0000000  4.1550000  1.0791667  3.7899038  2.2892096  5.5393548  2.4327273
1951  0.6090909  1.5419355  1.8307692 -0.1000000  1.3891566  3.9788095  7.4421311
1952  3.3191176  1.3418248 11.7590909  0.0000000  2.1944444 30.0066667  4.2485876
1953  2.2772152 10.1666667  0.9000000  1.6428571  1.3718750  1.4842105  2.9021277
1954  1.9406250  4.9812500  0.2000000  3.4350000  2.7386667  1.1971667  6.7117647
1955 10.5500000  1.3313514  2.5523810  5.3130435  1.3333333  1.6974138  1.3850000
1956  5.0595238  4.5000000  0.6250000 11.0500000  1.4500000  2.8826087  2.1251462
1957  5.5357143  2.4911765  4.7718310  3.5910448  1.1300000  2.5321678  6.8821138
1958  2.3300000  1.2360656  1.3791667  3.8400000  9.3000000  1.5885714  6.0823529
1959  1.8467500 13.2304348  3.7689655  3.1061224  5.0210526  7.4503817  0.8666667
1960  2.3767442  3.1982727  5.3500000  2.3022059  2.7710280  3.4388889  4.0281899
1961  4.8807692  3.7375000  5.0654321  2.5760870  6.4402439  2.3293204 13.1619048
1962  5.6462687  1.9178571  5.5365854  1.6107143  1.3189655  3.1109091  8.0010000
1963  1.0312500  2.1233333  4.2090909  1.0764865  0.6411765  8.7858065  1.1303571
1964  0.2000000  1.9266667  3.9676471  6.1600000  2.9400000  3.7977215  0.6653061
1965  1.4454545  4.4294118  0.1000000  2.2818085  1.3265672  3.3730769  1.4558824
1966  2.8844706  1.8326531  5.8050000  1.8272727 11.7333333  1.6790441  2.7777778
1967  5.0755556  4.1363636  2.6311111  0.5500000  9.4735294  4.7928571  1.0406667
1968  4.5761111  5.0676471  3.3978182  2.6613333  2.6365672  2.4593750  0.9779412
1969  1.8342857  4.5024752  3.2666667  6.2076087  2.1873913  6.3488889  0.9222222
1970  4.7263158  3.6044776  1.0684211  1.3326733  2.6485149  1.7832117  4.3742857
1971  2.2614286  2.7037975  8.6000000  1.8337864  1.3817073  0.7574074  4.2938776
1972  0.1750000  3.9454545  8.7000000  3.6897661  2.8307692  4.8039216  1.1058824
1973  1.8538462  2.6051724  0.8500000  2.2932184  1.7289017  1.3166667  0.8758621
1974  1.3753846  9.3617647  3.1486631  0.7452632  6.2000000  0.9166667  0.1400000
1975  1.8901575  2.7393617  1.3571429  7.4243590  2.5175000  6.9881279  7.4774390
1976  2.0558333  0.1868421  1.5678304  6.5189873  4.3909091  0.8263158  2.3984375
1977 10.9319444 12.5161290  4.6263158  6.4764706  1.5917808  4.2323077  2.4888525
1978  8.6521739  2.3386486  9.5013158  8.8914729  3.6277778  1.2000000  6.2403509
1979  0.9950000  7.4517241  4.0565217  1.6650794  6.3294118  3.1173913  2.9627562
1980  1.1229885  1.1285714  3.8009091  3.3441176 10.5807692  2.0363636  6.7714286
1981  0.5142857  3.4792683  3.6869565  1.3476190  2.7441176  0.7481481  6.6152778
1982  0.9041667  5.6045455 10.3666667  4.0208252  3.0200000  0.8320000 16.4800000
1983 12.7700000  1.0400000  5.6098765  0.7000000 11.3360656  4.0476510  1.6259259
1984  5.8398551  3.9500000  2.9524444  0.9894737  1.8653061  2.1668462  1.0400000
1985  5.9210000  0.6000000  1.1538462  5.7285714  1.2324324  3.4500000  5.6388889
1986  1.7500000  3.2033333  1.7928571  2.0277193  2.9830986  2.4072603  1.1666667
1987  0.8323810  2.4465116  2.4496241  5.5833333  4.3347826 12.2151203  5.0212121
1988  3.5795266  4.7166667  4.1448980 14.9000000  1.0418421  2.3750000  3.2745283
1989  4.3250000  7.6431373  3.1251407  5.2763158  1.9253731  5.5862745  1.1359375
1990  3.1011905  2.5233333  5.0951049  1.1062500  1.9624242  1.3952381  2.9384615
1991  1.8032258  2.3166667  1.7750943  3.5327586  1.3416667  1.1891892 20.2000000
1992  6.1209036  3.0708197  1.3666667  4.2888889  3.0339130 11.3500000  1.5111111
1993  5.2343137  1.9829070  7.8566845  1.1506349 22.9590909  0.0800000  2.6837209
1994  1.5112033 12.9365854  1.1654762  3.7333333  1.1787500  5.5968750  5.3187500
1995  2.0526316 15.2565217  2.4675978  1.6505263  3.4870968  2.5694118  1.5360465
1996  0.4500000  5.1020455  2.1522293  3.6668750  0.6732143  2.4464135  1.0636364
1997  0.9676923  4.5563810  3.7434091  1.2460000  0.9700000  1.9100000  2.1454545
1998  2.5301075  4.4212766  1.1550000  2.9441176  2.3268125  2.0884766  2.5246470
1999  2.6640000  1.2076923  0.8904348  1.8000000  2.9876712  9.9666667  9.4417323
2000  3.2041667  4.7571429  4.3971660  0.6961538  0.8304348  3.5641026  1.9621622
2001  1.5225490  1.2257143  2.6400000  0.6000000  1.0115702  1.3000000  1.6253012
2002  0.1000000  0.5880952  1.1961538  4.5351351  4.0175824  7.1058824  3.0681818
2003  3.4515152  1.2869159  6.4195270  3.2124719  2.7777778  1.2103774  2.7770000
            Aug        Sep        Oct        Nov        Dec
1950  5.0823377  1.6938596  3.9465116 12.4029412  1.5687500
1951  1.2106796  1.8338983  4.5318966 11.2500000  2.6600000
1952  3.1196078  1.7166667  1.3882682  0.9225806  2.6156250
1953  8.9937500  1.5000000  0.9656566  5.2285714  2.7835690
1954  1.1125243  2.9866667  7.5008446  4.0360000  4.6736842
1955  2.0835821  4.7605839  2.0920000  3.1428571  3.8436364
1956  2.7638889  6.3809524  1.2578947  1.5660714  6.2214286
1957  1.3416667  0.3000000  1.5768166  4.3194444 11.0000000
1958  6.7781013  4.1919753  2.3918699  1.1295455  3.4625000
1959  7.4787500  5.8523256  8.7628000 10.8600000  2.0141600
1960  1.0777027  2.9400000  3.2114634  2.5160377  0.3600000
1961  2.2360959  2.9941304  6.4096078  2.5888889  3.1753846
1962  3.2455696  8.6188889  2.7111111  1.6225000  1.3720280
1963  2.9365969  2.5468750  1.8241667  1.7967742  5.4971429
1964  5.7514286  3.8476190  6.3964706  1.7266387  8.4870968
1965  4.3615385  1.4875000  0.8524390  0.7500000  1.9147368
1966  6.1180714  0.9500000  1.8271429  4.7790323  4.2841060
1967  2.8102837  1.8129464  2.3144776  0.9285714  2.1430894
1968  2.1790000  9.9076923  3.1222222  1.5830189  0.6708333
1969  1.9894737  2.3137500  0.7157895  2.5802548  5.0151376
1970  4.7937838  2.1571429  4.7176471  3.2495049  1.6583333
1971  0.7060606  1.2295238  1.0212329  1.1000000  3.0802326
1972  5.3612069  3.3108108  5.0750000  7.1000000  3.3400000
1973  4.8652174  1.8200000  0.0800000  5.2723864  8.2444444
1974  4.9183966  1.2809524  5.2291667  5.5651786  3.2008000
1975  2.0951220  5.3095238  1.0797468  1.6380952  3.7527273
1976 10.8000000  3.8722222  2.2842105  0.2555556  1.7604167
1977  1.3882353  4.7812500  3.6987013  1.7766667  5.2568750
1978  1.3330435  1.2201493  6.9658537  3.5315789  1.6129808
1979  1.4457627  2.3000000  1.5879661  4.6795812  2.7473684
1980  1.2894737  2.5723077  0.9090909  3.8197674  6.6541667
1981  4.4120000  3.9050000  1.7300000  1.6620253  0.9800000
1982  9.5354430  1.9971014  3.0985714  0.5200000  6.0666667
1983  1.8685990  2.3000000  4.6750000  7.8932039  2.8315068
1984  4.9320000  1.8164557  3.7543478  3.7217391  1.4717391
1985  1.6136364  2.3852381  4.0815789  1.1402778  3.3178571
1986  4.7573810  2.7847059  2.0411765  3.4439024  1.5892857
1987  4.4366013  4.1666667  5.5852459  2.7857143  0.7757282
1988  2.1219512  3.6099174  3.7642857  0.9709302  2.3000000
1989  3.6815534  2.0889474  2.6382353  1.2782609  5.5765957
1990 -0.1000000  3.8793269  8.5687500  3.2320000  4.3520000
1991  2.3066667  4.3678082  0.5066667  1.5117355  0.8500000
1992  2.2201826  8.3428571  3.4082558  2.9803653  2.7287037
1993  2.2557143  2.1850000  7.2973684  2.0384615  1.0760000
1994  3.5800000  8.5152542  3.6554945  5.0545455  1.6641509
1995  1.7101695  1.1555556  0.4126984  5.0060440  7.5800000
1996  3.0538462  1.4748387  5.6157407 29.3000000  3.6750000
1997  0.3300000  4.2703053  1.7262295  2.6984848  2.3000000
1998  3.9000000  3.3200000 14.5909091  2.5964103  9.4687500
1999  0.9928571  4.0176471  9.6000000  0.4235294  1.6000000
2000  2.0545455  4.0131148  1.0000000 13.3500000  5.6552632
2001  2.9789474 10.8818182  2.3000000  1.6571429  5.1106667
2002  6.3166667  3.3036232  2.5438642  2.7184874  0.8000000
2003                                                       
> tornlents
            Jan        Feb        Mar        Apr        May        Jun        Jul
1950  0.2000000  4.3550000  1.2791667  3.9899038  2.4892096  5.7393548  2.6327273
1951  0.8090909  1.7419355  2.0307692  0.1000000  1.5891566  4.1788095  7.6421311
1952  3.5191176  1.5418248 11.9590909  0.2000000  2.3944444 30.2066667  4.4485876
1953  2.4772152 10.3666667  1.1000000  1.8428571  1.5718750  1.6842105  3.1021277
1954  2.1406250  5.1812500  0.4000000  3.6350000  2.9386667  1.3971667  6.9117647
1955 10.7500000  1.5313514  2.7523810  5.5130435  1.5333333  1.8974138  1.5850000
1956  5.2595238  4.7000000  0.8250000 11.2500000  1.6500000  3.0826087  2.3251462
1957  5.7357143  2.6911765  4.9718310  3.7910448  1.3300000  2.7321678  7.0821138
1958  2.5300000  1.4360656  1.5791667  4.0400000  9.5000000  1.7885714  6.2823529
1959  2.0467500 13.4304348  3.9689655  3.3061224  5.2210526  7.6503817  1.0666667
1960  2.5767442  3.3982727  5.5500000  2.5022059  2.9710280  3.6388889  4.2281899
1961  5.0807692  3.9375000  5.2654321  2.7760870  6.6402439  2.5293204 13.3619048
1962  5.8462687  2.1178571  5.7365854  1.8107143  1.5189655  3.3109091  8.2010000
1963  1.2312500  2.3233333  4.4090909  1.2764865  0.8411765  8.9858065  1.3303571
1964  0.4000000  2.1266667  4.1676471  6.3600000  3.1400000  3.9977215  0.8653061
1965  1.6454545  4.6294118  0.3000000  2.4818085  1.5265672  3.5730769  1.6558824
1966  3.0844706  2.0326531  6.0050000  2.0272727 11.9333333  1.8790441  2.9777778
1967  5.2755556  4.3363636  2.8311111  0.7500000  9.6735294  4.9928571  1.2406667
1968  4.7761111  5.2676471  3.5978182  2.8613333  2.8365672  2.6593750  1.1779412
1969  2.0342857  4.7024752  3.4666667  6.4076087  2.3873913  6.5488889  1.1222222
1970  4.9263158  3.8044776  1.2684211  1.5326733  2.8485149  1.9832117  4.5742857
1971  2.4614286  2.9037975  8.8000000  2.0337864  1.5817073  0.9574074  4.4938776
1972  0.3750000  4.1454545  8.9000000  3.8897661  3.0307692  5.0039216  1.3058824
1973  2.0538462  2.8051724  1.0500000  2.4932184  1.9289017  1.5166667  1.0758621
1974  1.5753846  9.5617647  3.3486631  0.9452632  6.4000000  1.1166667  0.3400000
1975  2.0901575  2.9393617  1.5571429  7.6243590  2.7175000  7.1881279  7.6774390
1976  2.2558333  0.3868421  1.7678304  6.7189873  4.5909091  1.0263158  2.5984375
1977 11.1319444 12.7161290  4.8263158  6.6764706  1.7917808  4.4323077  2.6888525
1978  8.8521739  2.5386486  9.7013158  9.0914729  3.8277778  1.4000000  6.4403509
1979  1.1950000  7.6517241  4.2565217  1.8650794  6.5294118  3.3173913  3.1627562
1980  1.3229885  1.3285714  4.0009091  3.5441176 10.7807692  2.2363636  6.9714286
1981  0.7142857  3.6792683  3.8869565  1.5476190  2.9441176  0.9481481  6.8152778
1982  1.1041667  5.8045455 10.5666667  4.2208252  3.2200000  1.0320000 16.6800000
1983 12.9700000  1.2400000  5.8098765  0.9000000 11.5360656  4.2476510  1.8259259
1984  6.0398551  4.1500000  3.1524444  1.1894737  2.0653061  2.3668462  1.2400000
1985  6.1210000  0.8000000  1.3538462  5.9285714  1.4324324  3.6500000  5.8388889
1986  1.9500000  3.4033333  1.9928571  2.2277193  3.1830986  2.6072603  1.3666667
1987  1.0323810  2.6465116  2.6496241  5.7833333  4.5347826 12.4151203  5.2212121
1988  3.7795266  4.9166667  4.3448980 15.1000000  1.2418421  2.5750000  3.4745283
1989  4.5250000  7.8431373  3.3251407  5.4763158  2.1253731  5.7862745  1.3359375
1990  3.3011905  2.7233333  5.2951049  1.3062500  2.1624242  1.5952381  3.1384615
1991  2.0032258  2.5166667  1.9750943  3.7327586  1.5416667  1.3891892 20.4000000
1992  6.3209036  3.2708197  1.5666667  4.4888889  3.2339130 11.5500000  1.7111111
1993  5.4343137  2.1829070  8.0566845  1.3506349 23.1590909  0.2800000  2.8837209
1994  1.7112033 13.1365854  1.3654762  3.9333333  1.3787500  5.7968750  5.5187500
1995  2.2526316 15.4565217  2.6675978  1.8505263  3.6870968  2.7694118  1.7360465
1996  0.6500000  5.3020455  2.3522293  3.8668750  0.8732143  2.6464135  1.2636364
1997  1.1676923  4.7563810  3.9434091  1.4460000  1.1700000  2.1100000  2.3454545
1998  2.7301075  4.6212766  1.3550000  3.1441176  2.5268125  2.2884766  2.7246470
1999  2.8640000  1.4076923  1.0904348  2.0000000  3.1876712 10.1666667  9.6417323
2000  3.4041667  4.9571429  4.5971660  0.8961538  1.0304348  3.7641026  2.1621622
2001  1.7225490  1.4257143  2.8400000  0.8000000  1.2115702  1.5000000  1.8253012
2002  0.3000000  0.7880952  1.3961538  4.7351351  4.2175824  7.3058824  3.2681818
2003  3.6515152  1.4869159  6.6195270  3.4124719  2.9777778  1.4103774  2.9770000
            Aug        Sep        Oct        Nov        Dec
1950  5.2823377  1.8938596  4.1465116 12.6029412  1.7687500
1951  1.4106796  2.0338983  4.7318966 11.4500000  2.8600000
1952  3.3196078  1.9166667  1.5882682  1.1225806  2.8156250
1953  9.1937500  1.7000000  1.1656566  5.4285714  2.9835690
1954  1.3125243  3.1866667  7.7008446  4.2360000  4.8736842
1955  2.2835821  4.9605839  2.2920000  3.3428571  4.0436364
1956  2.9638889  6.5809524  1.4578947  1.7660714  6.4214286
1957  1.5416667  0.5000000  1.7768166  4.5194444 11.2000000
1958  6.9781013  4.3919753  2.5918699  1.3295455  3.6625000
1959  7.6787500  6.0523256  8.9628000 11.0600000  2.2141600
1960  1.2777027  3.1400000  3.4114634  2.7160377  0.5600000
1961  2.4360959  3.1941304  6.6096078  2.7888889  3.3753846
1962  3.4455696  8.8188889  2.9111111  1.8225000  1.5720280
1963  3.1365969  2.7468750  2.0241667  1.9967742  5.6971429
1964  5.9514286  4.0476190  6.5964706  1.9266387  8.6870968
1965  4.5615385  1.6875000  1.0524390  0.9500000  2.1147368
1966  6.3180714  1.1500000  2.0271429  4.9790323  4.4841060
1967  3.0102837  2.0129464  2.5144776  1.1285714  2.3430894
1968  2.3790000 10.1076923  3.3222222  1.7830189  0.8708333
1969  2.1894737  2.5137500  0.9157895  2.7802548  5.2151376
1970  4.9937838  2.3571429  4.9176471  3.4495050  1.8583333
1971  0.9060606  1.4295238  1.2212329  1.3000000  3.2802326
1972  5.5612069  3.5108108  5.2750000  7.3000000  3.5400000
1973  5.0652174  2.0200000  0.2800000  5.4723864  8.4444444
1974  5.1183966  1.4809524  5.4291667  5.7651786  3.4008000
1975  2.2951220  5.5095238  1.2797468  1.8380952  3.9527273
1976 11.0000000  4.0722222  2.4842105  0.4555556  1.9604167
1977  1.5882353  4.9812500  3.8987013  1.9766667  5.4568750
1978  1.5330435  1.4201493  7.1658537  3.7315789  1.8129808
1979  1.6457627  2.5000000  1.7879661  4.8795812  2.9473684
1980  1.4894737  2.7723077  1.1090909  4.0197674  6.8541667
1981  4.6120000  4.1050000  1.9300000  1.8620253  1.1800000
1982  9.7354430  2.1971014  3.2985714  0.7200000  6.2666667
1983  2.0685990  2.5000000  4.8750000  8.0932039  3.0315068
1984  5.1320000  2.0164557  3.9543478  3.9217391  1.6717391
1985  1.8136364  2.5852381  4.2815789  1.3402778  3.5178571
1986  4.9573810  2.9847059  2.2411765  3.6439024  1.7892857
1987  4.6366013  4.3666667  5.7852459  2.9857143  0.9757282
1988  2.3219512  3.8099174  3.9642857  1.1709302  2.5000000
1989  3.8815534  2.2889474  2.8382353  1.4782609  5.7765957
1990  0.1000000  4.0793269  8.7687500  3.4320000  4.5520000
1991  2.5066667  4.5678082  0.7066667  1.7117355  1.0500000
1992  2.4201826  8.5428571  3.6082558  3.1803653  2.9287037
1993  2.4557143  2.3850000  7.4973684  2.2384615  1.2760000
1994  3.7800000  8.7152542  3.8554945  5.2545455  1.8641509
1995  1.9101695  1.3555556  0.6126984  5.2060440  7.7800000
1996  3.2538462  1.6748387  5.8157407 29.5000000  3.8750000
1997  0.5300000  4.4703053  1.9262295  2.8984848  2.5000000
1998  4.1000000  3.5200000 14.7909091  2.7964103  9.6687500
1999  1.1928571  4.2176471  9.8000000  0.6235294  1.8000000
2000  2.2545455  4.2131148  1.2000000 13.5500000  5.8552632
2001  3.1789474 11.0818182  2.5000000  1.8571429  5.3106667
2002  6.5166667  3.5036232  2.7438642  2.9184874  1.0000000
2003                                                       
> predict12 = predict(modelMA1,n.ahead=12,se.fit=T)
> predict12
$pred
               Jan           Feb           Mar           Apr           May           Jun
2003                                                                                    
2004 -2.026179e-05 -2.026179e-05 -2.026179e-05 -2.026179e-05 -2.026179e-05 -2.026179e-05
               Jul           Aug           Sep           Oct           Nov           Dec
2003                8.496910e-01 -2.026179e-05 -2.026179e-05 -2.026179e-05 -2.026179e-05
2004 -2.026179e-05                                                                      

$se
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                3.286863 4.644715
2004 4.644715 4.644715 4.644715 4.644715 4.644715 4.644715 4.644715                  
          Oct      Nov      Dec
2003 4.644715 4.644715 4.644715
2004                           

> diffinv(predict12)
Error in diffinv.vector(x, lag, differences, xi) : 
  (list) object cannot be coerced to type 'double'
> diffinv(-2.026179e-05)
[1]  0.000000e+00 -2.026179e-05
> diffinv(8.496910e-01)
[1] 0.000000 0.849691
> 
> 
> avglendiff=diff(avglen)
> acf(coredata(avglendiff),plot=T,lag.max=20,na.action=na.pass)
> modeldiffMA1 = arima(avglendiff,c(0,0,1))
> modeldiffMA1

Call:
arima(x = avglendiff, order = c(0, 0, 1))

Coefficients:
          ma1  intercept
      -1.0000      0e+00
s.e.   0.0047      7e-04

sigma^2 estimated as 10.79:  log likelihood = -1677.63,  aic = 3361.26
> Box.test(coredata(modeldiffMA1$residuals),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(modeldiffMA1$residuals)
X-squared = 4.0533, df = 6, p-value = 0.6695

> predictAR10 = predict(modelAR10,n.ahead=12,se.fit=T)
> predictAR10
$pred
              Jan          Feb          Mar          Apr          May          Jun
2003                                                                              
2004 -0.399067451  0.119413013 -0.407226828  0.069943916 -0.068144761  0.152608647
              Jul          Aug          Sep          Oct          Nov          Dec
2003              -0.125569766 -0.078351453  0.050204656  0.157755572  0.484321884
2004 -0.001753689                                                                 

$se
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                3.396884 4.712427
2004 4.715707 4.715879 4.715988 4.727390 4.728917 4.735234 4.738582                  
          Oct      Nov      Dec
2003 4.712725 4.715342 4.715654
2004                           

> diffinv(-0.399067451)
[1]  0.0000000 -0.3990675
> diffinv(predictAR10)
Error in diffinv.vector(x, lag, differences, xi) : 
  (list) object cannot be coerced to type 'double'
> diffinv(0.119413013)
[1] 0.000000 0.119413
> predictARMA12=predict(modelARMA12,n.ahead=12,se.fit=T)
Error in is.constant(y) : 
  (list) object cannot be coerced to type 'double'
> forecast(modelMA1,4)
         Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003   8.496910e-01 -3.362593 5.061975 -5.592441 7.291823
Sep 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Oct 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Nov 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
> forecast(modelMA1,12)
         Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003   8.496910e-01 -3.362593 5.061975 -5.592441 7.291823
Sep 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Oct 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Nov 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Dec 2003  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Jan 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Feb 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Mar 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Apr 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
May 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Jun 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
Jul 2004  -2.026179e-05 -5.952462 5.952422 -9.103495 9.103454
> save.image("E:\\MITM\\Fall 2017\\ITMD527\\RProject\\fulltornadoes\\timeseries\\Timeseries.RData")
> arimaModel=arima(10,1,1)
Error in arima(10, 1, 1) : 
  'order' must be a non-negative numeric vector of length 3
> arimaModel=arima(tornlentsdiff,c(10,1,1))
> arimaModel

Call:
arima(x = tornlentsdiff, order = c(10, 1, 1))

Coefficients:
          ar1      ar2      ar3      ar4      ar5      ar6      ar7      ar8      ar9
      -0.9601  -0.9063  -0.8093  -0.7349  -0.6603  -0.5819  -0.5200  -0.3686  -0.1962
s.e.   0.0393   0.0542   0.0635   0.0681   0.0703   0.0702   0.0679   0.0632   0.0541
         ar10      ma1
      -0.1137  -1.0000
s.e.   0.0393   0.0041

sigma^2 estimated as 11.56:  log likelihood = -1700,  aic = 3424
> arimaModelactual=arima(tornlents,c(10,1,1))
> arimaModelactual

Call:
arima(x = tornlents, order = c(10, 1, 1))

Coefficients:
          ar1      ar2      ar3      ar4      ar5      ar6      ar7     ar8     ar9
      -0.0526  -0.0408  -0.0075  -0.0367  -0.0342  -0.0307  -0.0463  0.0434  0.0684
s.e.   0.0395   0.0395   0.0395   0.0394   0.0394   0.0394   0.0394  0.0394  0.0394
         ar10      ma1
      -0.0111  -1.0000
s.e.   0.0394   0.0051

sigma^2 estimated as 10.6:  log likelihood = -1672.33,  aic = 3368.66
> predictActualArima12=predict(arimaModelactual,n.ahead=12,se.fit=T)
> predictActualArima12
$pred
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                3.811529 3.765790
2004 3.856453 3.704301 3.644670 3.804829 3.836163 3.816769 3.831734                  
          Oct      Nov      Dec
2003 3.764346 3.963185 4.173208
2004                           

$se
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                3.258896 3.263133
2004 3.268433 3.269301 3.271797 3.276338 3.284431 3.284909 3.284911                  
          Oct      Nov      Dec
2003 3.265307 3.265310 3.267096
2004                           

> predictActualArima12=predict(arimaModelactual,test.data,se.fit=T)
Error in KalmanForecast(n.ahead, object$model) : 
  (list) object cannot be coerced to type 'integer'
> predictAR10=predict.glm(arimaModelactual,test.data)
Error in terms.default(object) : no terms component nor attribute
> 
> 
> $creating test time series object for prediction validation
Error: unexpected '$' in "$"
> #creating test time series object for prediction validation
> 
> 
> testlen=test.data$avglength
> testlents=ts(testlen,start=c(2004,1),frequency=12)
> testlents
            Jan        Feb        Mar        Apr        May        Jun        Jul
2004  0.4916667  0.6333333  2.3550000  4.4758621  5.2437500  4.7644444  1.7560000
2005  2.6583333  3.7692308 10.8437500  2.9692308  2.0214286 15.0000000  3.6269231
2006  2.1398990  2.2452675  1.7444444  0.4500000  2.3166667  1.0129496  1.0000000
2007  0.6115385  0.5811321  0.1000000  2.1125000  3.5500000  1.4657895  0.8285714
2008  1.0500000  1.0710145  1.9098039  2.7732000  4.3410714  2.4410256  2.1242152
2009  1.3578947  1.8028169  4.4500000  2.3952419  8.5448980  3.3777778  7.5393939
2010  6.1681818  0.7823529  4.3561728  6.3234375  3.2015075  5.6214286  2.7708333
2011  2.7111111  2.8117647  6.5168367  2.6846667  6.7787037  6.7644444  0.7956522
2012  1.0000000  0.5765957  1.0113636  7.3888889  3.6000000  1.7960000  1.4285714
2013  1.4269231  2.3568047  0.1000000  5.0285714  0.8793103  5.4676667  1.2333333
2014  2.8900000  2.2333333  4.9523256  2.6573574  3.0000000  7.0857143  1.4455814
2015  4.3933333  1.8638298  5.4050980  0.2500000  3.4092784  1.7794118  2.7460000
2016  1.9783784  3.0196429  4.4828571  1.1583333  1.8820189  1.5000000  3.9101415
2017  1.7545455  4.1280000  1.6311475  3.5215000  3.1851064                      
            Aug        Sep        Oct        Nov        Dec
2004  4.5815126  1.4593750  6.6500000  3.6302158  8.2500000
2005  1.5041237  3.7000000  1.2641667  3.3600000  1.7285714
2006  4.2666667  2.3026316  2.9256000  1.8250000  2.7900923
2007  4.0055556  5.1666667  3.0928571  1.6666667  2.3175439
2008  2.2605357  2.2366667  2.4270000  1.0285714  4.9965517
2009  1.1642857  5.2402844  4.3857143  3.3377778  1.2086842
2010  3.2666667 11.2088889  7.5370000  3.7375000  3.1839506
2011  5.5937500  9.4285714  1.3069697  1.0000000 16.8347826
2012  0.8319444  1.0222222  0.8333333  2.9666667  6.5954545
2013  4.5842593  2.4565217  6.7611429  7.5870000  6.4432184
2014  5.5459627  2.9728814  1.0039216  0.2333333  6.0247368
2015  1.0589744  2.2750000  3.2340909  1.9009709  2.8854545
2016  2.0867308  4.5029412  4.0099567  2.0458333  1.8473684
2017                                                       
> accuracy(predictActualArima12)
Error in accuracy.default(predictActualArima12) : 
  First argument should be a forecast object or a time series.
> accuracy(testlents,predictActualArima12)
Error in xx - ff[1:n] : non-numeric argument to binary operator
> testmodel=arima(testlents,c(10,1,1))
> testmodel

Call:
arima(x = testlents, order = c(10, 1, 1))

Coefficients:
          ar1     ar2     ar3     ar4      ar5     ar6     ar7     ar8      ar9     ar10
      -0.0528  0.0082  0.1941  0.1549  -0.0046  0.1630  0.0999  0.0589  -0.0358  -0.1563
s.e.   0.0783  0.0786  0.0782  0.0792   0.0801  0.0796  0.0795  0.0779   0.0780   0.0781
          ma1
      -1.0000
s.e.   0.0198

sigma^2 estimated as 5.948:  log likelihood = -372.01,  aic = 768.02
> library(forecast)
> forecast(testmodel)
         Point Forecast        Lo 80    Hi 80     Lo 95    Hi 95
Jun 2017       2.932141 -0.202809419 6.067091 -1.862352 7.726634
Jul 2017       2.401129 -0.737202413 5.539460 -2.398534 7.200792
Aug 2017       3.179398  0.040682563 6.318113 -1.620853 7.979649
Sep 2017       3.162724 -0.037250003 6.362697 -1.731214 8.056661
Oct 2017       3.262227  0.031751093 6.492703 -1.678360 8.202814
Nov 2017       3.243278  0.012782151 6.473774 -1.697339 8.183895
Dec 2017       3.119748 -0.178314637 6.417810 -1.924203 8.163699
Jan 2018       3.330302  0.001107503 6.659497 -1.761262 8.421867
Feb 2018       3.105408 -0.232250449 6.443066 -1.999100 8.209915
Mar 2018       3.196992 -0.142629140 6.536614 -1.910518 8.304502
Apr 2018       3.331097 -0.011358484 6.673553 -1.780748 8.442942
May 2018       3.375338  0.024499140 6.726177 -1.749328 8.500004
Jun 2018       3.218840 -0.135872968 6.573554 -1.911751 8.349432
Jul 2018       3.288644 -0.066020218 6.643309 -1.841872 8.419161
Aug 2018       3.274829 -0.081101658 6.630760 -1.857624 8.407282
Sep 2018       3.264237 -0.094198163 6.622672 -1.872046 8.400521
Oct 2018       3.283316 -0.075784246 6.642417 -1.853985 8.420618
Nov 2018       3.292212 -0.066723826 6.651148 -1.844837 8.429261
Dec 2018       3.306075 -0.053232023 6.665382 -1.831542 8.443692
Jan 2019       3.286783 -0.072632146 6.646198 -1.850999 8.424565
Feb 2019       3.265598 -0.093972561 6.625169 -1.872422 8.403618
Mar 2019       3.270229 -0.089226038 6.629684 -1.867614 8.408072
Apr 2019       3.291377 -0.067951335 6.650705 -1.846272 8.429025
May 2019       3.275446 -0.083816999 6.634709 -1.862103 8.412995
> accuracy(forecast(testmodel))
                     ME     RMSE      MAE       MPE     MAPE      MASE          ACF1
Training set 0.06962324 2.431292 1.838651 -99.01874 129.8209 0.7372323 -0.0009434062
> accuracy(forecast(modelAR10))
                     ME     RMSE      MAE      MPE     MAPE      MASE         ACF1
Training set 0.01069801 3.396884 2.314587 5.107815 259.7623 0.4820138 -0.009523717
> forecast(modelAR10)
         Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003   -0.125569766 -4.478851 4.227712 -6.783339 6.532200
Sep 2003   -0.078351453 -6.117570 5.960867 -9.314539 9.157836
Oct 2003    0.050204656 -5.989395 6.089804 -9.186566 9.286975
Nov 2003    0.157755572 -5.885199 6.200710 -9.084145 9.399657
Dec 2003    0.484321884 -5.559031 6.527675 -8.758189 9.726833
Jan 2004   -0.399067451 -6.442489 5.644354 -9.641683 8.843548
Feb 2004    0.119413013 -5.924230 6.163056 -9.123541 9.362367
Mar 2004   -0.407226828 -6.451008 5.636555 -9.650393 8.835939
Apr 2004    0.069943916 -5.988450 6.128338 -9.195570 9.335458
May 2004   -0.068144761 -6.128496 5.992207 -9.336653 9.200363
Jun 2004    0.152608647 -5.915838 6.221055 -9.128279 9.433496
Jul 2004   -0.001753689 -6.074491 6.070983 -9.289204 9.285696
Aug 2004    0.056953923 -6.029652 6.143560 -9.251707 9.365615
Sep 2004    0.034678701 -6.051982 6.121339 -9.274065 9.343423
Oct 2004   -0.001733848 -6.088602 6.085134 -9.310795 9.307327
Nov 2004   -0.001393908 -6.088266 6.085479 -9.310462 9.307674
Dec 2004   -0.080838947 -6.167849 6.006171 -9.390117 9.228439
Jan 2005   -0.005783908 -6.093250 6.081683 -9.315761 9.304193
Feb 2005   -0.027423146 -6.114890 6.060044 -9.337400 9.282554
Mar 2005    0.025402458 -6.062135 6.112940 -9.284682 9.335487
Apr 2005    0.008195079 -6.079361 6.095751 -9.301918 9.318308
May 2005    0.024903454 -6.063078 6.112884 -9.285860 9.335667
Jun 2005    0.005259365 -6.082733 6.093252 -9.305521 9.316040
Jul 2005    0.005607873 -6.082466 6.093682 -9.305298 9.316514
> #build AR(10) model with d=1
> modelAR10d1 = arima(tornlents,c(10,1,0))
> modelAR10d1

Call:
arima(x = tornlents, order = c(10, 1, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540
         ar10
      -0.1151
s.e.   0.0393

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3415.97
> forecast(modelAR10d1)
         Point Forecast      Lo 80    Hi 80     Lo 95     Hi 95
Aug 2003       2.853546 -1.4997363 7.206829 -3.804225  9.511317
Sep 2003       2.775261 -1.5812408 7.131763 -3.887434  9.437956
Oct 2003       2.825593 -1.5372596 7.188446 -3.846814  9.498001
Nov 2003       2.983553 -1.4010963 7.368202 -3.722189  9.689295
Dec 2003       3.468052 -0.9319463 7.868051 -3.261165 10.197270
Jan 2004       3.069170 -1.3486083 7.486949 -3.687239  9.825580
Feb 2004       3.188793 -1.2516060 7.629192 -3.602211  9.979797
Mar 2004       2.781775 -1.6772084 7.240758 -4.037651  9.601201
Apr 2004       2.852125 -1.6829376 7.387188 -4.083655  9.787905
May 2004       2.784457 -1.8555435 7.424457 -4.311811  9.880725
Jun 2004       2.937382 -1.7504400 7.625204 -4.232023 10.106787
Jul 2004       2.936065 -1.8366405 7.708770 -4.363158 10.235287
Aug 2004       2.993250 -1.8040829 7.790583 -4.343638 10.330138
Sep 2004       3.028177 -1.7963167 7.852671 -4.350250 10.406604
Oct 2004       3.026711 -1.8303437 7.883765 -4.401513 10.454935
Nov 2004       3.025585 -1.8629788 7.914149 -4.450828 10.501998
Dec 2004       2.945036 -1.9796080 7.869680 -4.586557 10.476630
Jan 2005       2.939578 -2.0303806 7.909537 -4.661318 10.540474
Feb 2005       2.912482 -2.1025800 7.927544 -4.757393 10.582357
Mar 2005       2.938223 -2.1255092 8.001955 -4.806087 10.682533
Apr 2005       2.946749 -2.1631616 8.056660 -4.868185 10.761684
May 2005       2.971948 -2.1746546 8.118551 -4.899101 10.842998
Jun 2005       2.977510 -2.2069181 8.161938 -4.951388 10.906408
Jul 2005       2.983404 -2.2348847 8.201692 -4.997280 10.964087
> testlents
            Jan        Feb        Mar        Apr        May        Jun        Jul
2004  0.4916667  0.6333333  2.3550000  4.4758621  5.2437500  4.7644444  1.7560000
2005  2.6583333  3.7692308 10.8437500  2.9692308  2.0214286 15.0000000  3.6269231
2006  2.1398990  2.2452675  1.7444444  0.4500000  2.3166667  1.0129496  1.0000000
2007  0.6115385  0.5811321  0.1000000  2.1125000  3.5500000  1.4657895  0.8285714
2008  1.0500000  1.0710145  1.9098039  2.7732000  4.3410714  2.4410256  2.1242152
2009  1.3578947  1.8028169  4.4500000  2.3952419  8.5448980  3.3777778  7.5393939
2010  6.1681818  0.7823529  4.3561728  6.3234375  3.2015075  5.6214286  2.7708333
2011  2.7111111  2.8117647  6.5168367  2.6846667  6.7787037  6.7644444  0.7956522
2012  1.0000000  0.5765957  1.0113636  7.3888889  3.6000000  1.7960000  1.4285714
2013  1.4269231  2.3568047  0.1000000  5.0285714  0.8793103  5.4676667  1.2333333
2014  2.8900000  2.2333333  4.9523256  2.6573574  3.0000000  7.0857143  1.4455814
2015  4.3933333  1.8638298  5.4050980  0.2500000  3.4092784  1.7794118  2.7460000
2016  1.9783784  3.0196429  4.4828571  1.1583333  1.8820189  1.5000000  3.9101415
2017  1.7545455  4.1280000  1.6311475  3.5215000  3.1851064                      
            Aug        Sep        Oct        Nov        Dec
2004  4.5815126  1.4593750  6.6500000  3.6302158  8.2500000
2005  1.5041237  3.7000000  1.2641667  3.3600000  1.7285714
2006  4.2666667  2.3026316  2.9256000  1.8250000  2.7900923
2007  4.0055556  5.1666667  3.0928571  1.6666667  2.3175439
2008  2.2605357  2.2366667  2.4270000  1.0285714  4.9965517
2009  1.1642857  5.2402844  4.3857143  3.3377778  1.2086842
2010  3.2666667 11.2088889  7.5370000  3.7375000  3.1839506
2011  5.5937500  9.4285714  1.3069697  1.0000000 16.8347826
2012  0.8319444  1.0222222  0.8333333  2.9666667  6.5954545
2013  4.5842593  2.4565217  6.7611429  7.5870000  6.4432184
2014  5.5459627  2.9728814  1.0039216  0.2333333  6.0247368
2015  1.0589744  2.2750000  3.2340909  1.9009709  2.8854545
2016  2.0867308  4.5029412  4.0099567  2.0458333  1.8473684
2017                                                       
> predictar10d1=predict(modelAR10d1,n.ahead=12,se.fit=T)
> predictar10d1
$pred
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                2.853546 2.775261
2004 3.069170 3.188793 2.781775 2.852125 2.784457 2.937382 2.936065                  
          Oct      Nov      Dec
2003 2.825593 2.983553 3.468052
2004                           

$se
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                3.396884 3.399397
2004 3.447211 3.464862 3.479363 3.538728 3.620612 3.657927 3.724162                  
          Oct      Nov      Dec
2003 3.404352 3.421360 3.433337
2004                           

> testlen
  [1]  0.4916667  0.6333333  2.3550000  4.4758621  5.2437500  4.7644444  1.7560000
  [8]  4.5815126  1.4593750  6.6500000  3.6302158  8.2500000  2.6583333  3.7692308
 [15] 10.8437500  2.9692308  2.0214286 15.0000000  3.6269231  1.5041237  3.7000000
 [22]  1.2641667  3.3600000  1.7285714  2.1398990  2.2452675  1.7444444  0.4500000
 [29]  2.3166667  1.0129496  1.0000000  4.2666667  2.3026316  2.9256000  1.8250000
 [36]  2.7900923  0.6115385  0.5811321  0.1000000  2.1125000  3.5500000  1.4657895
 [43]  0.8285714  4.0055556  5.1666667  3.0928571  1.6666667  2.3175439  1.0500000
 [50]  1.0710145  1.9098039  2.7732000  4.3410714  2.4410256  2.1242152  2.2605357
 [57]  2.2366667  2.4270000  1.0285714  4.9965517  1.3578947  1.8028169  4.4500000
 [64]  2.3952419  8.5448980  3.3777778  7.5393939  1.1642857  5.2402844  4.3857143
 [71]  3.3377778  1.2086842  6.1681818  0.7823529  4.3561728  6.3234375  3.2015075
 [78]  5.6214286  2.7708333  3.2666667 11.2088889  7.5370000  3.7375000  3.1839506
 [85]  2.7111111  2.8117647  6.5168367  2.6846667  6.7787037  6.7644444  0.7956522
 [92]  5.5937500  9.4285714  1.3069697  1.0000000 16.8347826  1.0000000  0.5765957
 [99]  1.0113636  7.3888889  3.6000000  1.7960000  1.4285714  0.8319444  1.0222222
[106]  0.8333333  2.9666667  6.5954545  1.4269231  2.3568047  0.1000000  5.0285714
[113]  0.8793103  5.4676667  1.2333333  4.5842593  2.4565217  6.7611429  7.5870000
[120]  6.4432184  2.8900000  2.2333333  4.9523256  2.6573574  3.0000000  7.0857143
[127]  1.4455814  5.5459627  2.9728814  1.0039216  0.2333333  6.0247368  4.3933333
[134]  1.8638298  5.4050980  0.2500000  3.4092784  1.7794118  2.7460000  1.0589744
[141]  2.2750000  3.2340909  1.9009709  2.8854545  1.9783784  3.0196429  4.4828571
[148]  1.1583333  1.8820189  1.5000000  3.9101415  2.0867308  4.5029412  4.0099567
[155]  2.0458333  1.8473684  1.7545455  4.1280000  1.6311475  3.5215000  3.1851064
> accuracy(forecast(modelAR10d1))
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
> test.data$avglength
  [1]  0.4916667  0.6333333  2.3550000  4.4758621  5.2437500  4.7644444  1.7560000
  [8]  4.5815126  1.4593750  6.6500000  3.6302158  8.2500000  2.6583333  3.7692308
 [15] 10.8437500  2.9692308  2.0214286 15.0000000  3.6269231  1.5041237  3.7000000
 [22]  1.2641667  3.3600000  1.7285714  2.1398990  2.2452675  1.7444444  0.4500000
 [29]  2.3166667  1.0129496  1.0000000  4.2666667  2.3026316  2.9256000  1.8250000
 [36]  2.7900923  0.6115385  0.5811321  0.1000000  2.1125000  3.5500000  1.4657895
 [43]  0.8285714  4.0055556  5.1666667  3.0928571  1.6666667  2.3175439  1.0500000
 [50]  1.0710145  1.9098039  2.7732000  4.3410714  2.4410256  2.1242152  2.2605357
 [57]  2.2366667  2.4270000  1.0285714  4.9965517  1.3578947  1.8028169  4.4500000
 [64]  2.3952419  8.5448980  3.3777778  7.5393939  1.1642857  5.2402844  4.3857143
 [71]  3.3377778  1.2086842  6.1681818  0.7823529  4.3561728  6.3234375  3.2015075
 [78]  5.6214286  2.7708333  3.2666667 11.2088889  7.5370000  3.7375000  3.1839506
 [85]  2.7111111  2.8117647  6.5168367  2.6846667  6.7787037  6.7644444  0.7956522
 [92]  5.5937500  9.4285714  1.3069697  1.0000000 16.8347826  1.0000000  0.5765957
 [99]  1.0113636  7.3888889  3.6000000  1.7960000  1.4285714  0.8319444  1.0222222
[106]  0.8333333  2.9666667  6.5954545  1.4269231  2.3568047  0.1000000  5.0285714
[113]  0.8793103  5.4676667  1.2333333  4.5842593  2.4565217  6.7611429  7.5870000
[120]  6.4432184  2.8900000  2.2333333  4.9523256  2.6573574  3.0000000  7.0857143
[127]  1.4455814  5.5459627  2.9728814  1.0039216  0.2333333  6.0247368  4.3933333
[134]  1.8638298  5.4050980  0.2500000  3.4092784  1.7794118  2.7460000  1.0589744
[141]  2.2750000  3.2340909  1.9009709  2.8854545  1.9783784  3.0196429  4.4828571
[148]  1.1583333  1.8820189  1.5000000  3.9101415  2.0867308  4.5029412  4.0099567
[155]  2.0458333  1.8473684  1.7545455  4.1280000  1.6311475  3.5215000  3.1851064
> test.data
         date  avglength
313  1/1/1976  0.4916667
782  2/1/2015  0.6333333
800  8/1/2016  2.3550000
602  2/1/2000  4.4758621
38   2/1/1953  5.2437500
111  3/1/1959  4.7644444
342  6/1/1978  1.7560000
628  4/1/2002  4.5815126
645  9/1/2003  1.4593750
601  1/1/2000  6.6500000
174  6/1/1964  3.6302158
276 12/1/1972  8.2500000
47  11/1/1953  2.6583333
238 10/1/1969  3.7692308
109  1/1/1959 10.8437500
164  8/1/1963  2.9692308
449  5/1/1987  2.0214286
60  12/1/1954 15.0000000
718 10/1/2009  3.6269231
630  6/1/2002  1.5041237
681  9/1/2006  3.7000000
678  6/1/2006  1.2641667
225  9/1/1968  3.3600000
459  3/1/1988  1.7285714
390  6/1/1982  2.1398990
485  5/1/1990  2.2452675
356  8/1/1979  1.7444444
626  2/1/2002  0.4500000
211  7/1/1967  2.3166667
213  9/1/1967  1.0129496
444 12/1/1986  1.0000000
625  1/1/2002  4.2666667
393  9/1/1982  2.3026316
652  4/1/2004  2.9256000
145  1/1/1962  1.8250000
726  6/1/2010  2.7900923
381  9/1/1981  0.6115385
548  8/1/1995  0.5811321
409  1/1/1984  0.1000000
717  9/1/2009  2.1125000
120 12/1/1959  3.5500000
465  9/1/1988  1.4657895
266  2/1/1972  0.8285714
470  2/1/1989  4.0055556
23  11/1/1951  5.1666667
198  6/1/1966  3.0928571
569  5/1/1997  1.6666667
568  4/1/1997  2.3175439
22  10/1/1951  1.0500000
620  8/1/2001  1.0710145
427  7/1/1985  1.9098039
735  3/1/2011  2.7732000
591  3/1/1999  4.3410714
758  2/1/2013  2.4410256
378  6/1/1981  2.1242152
799  7/1/2016  2.2605357
200  8/1/1966  2.2366667
780 12/1/2014  2.4270000
212  8/1/1967  1.0285714
202 10/1/1966  4.9965517
453  9/1/1987  1.3578947
440  8/1/1986  1.8028169
58  10/1/1954  4.4500000
762  6/1/2013  2.3952419
74   2/1/1956  8.5448980
1    1/1/1950  3.3777778
277  1/1/1973  7.5393939
142 10/1/1961  1.1642857
210  6/1/1967  5.2402844
442 10/1/1986  4.3857143
489  9/1/1990  3.3377778
682 10/1/2006  1.2086842
178 10/1/1964  6.1681818
339  3/1/1978  0.7823529
172  4/1/1964  4.3561728
51   3/1/1954  6.3234375
258  6/1/1971  3.2015075
252 12/1/1970  5.6214286
578  2/1/1998  2.7708333
46  10/1/1953  3.2666667
27   3/1/1952 11.2088889
396 12/1/1982  7.5370000
144 12/1/1961  3.7375000
640  4/1/2003  3.1839506
385  1/1/1982  2.7111111
275 11/1/1972  2.8117647
425  5/1/1985  6.5168367
354  6/1/1979  2.6846667
686  2/1/2007  6.7787037
107 11/1/1958  6.7644444
533  5/1/1994  0.7956522
81   9/1/1956  5.5937500
42   6/1/1953  9.4285714
776  8/1/2014  1.3069697
33   9/1/1952  1.0000000
98   2/1/1958 16.8347826
648 12/1/2003  1.0000000
416  8/1/1984  0.5765957
450  6/1/1987  1.0113636
21   9/1/1951  7.3888889
62   2/1/1955  3.6000000
146  2/1/1962  1.7960000
383 11/1/1981  1.4285714
498  6/1/1991  0.8319444
394 10/1/1982  1.0222222
649  1/1/2004  0.8333333
207  3/1/1967  2.9666667
71  11/1/1955  6.5954545
672 12/1/2005  1.4269231
318  6/1/1976  2.3568047
193  1/1/1966  0.1000000
168 12/1/1963  5.0285714
493  1/1/1991  0.8793103
687  3/1/2007  5.4676667
357  9/1/1979  1.2333333
138  6/1/1961  4.5842593
502 10/1/1991  2.4565217
791 11/1/2015  6.7611429
64   4/1/1955  7.5870000
792 12/1/2015  6.4432184
783  3/1/2015  2.8900000
310 10/1/1975  2.2333333
303  3/1/1975  4.9523256
389  5/1/1982  2.6573574
430 10/1/1985  3.0000000
220  4/1/1968  7.0857143
511  7/1/1992  1.4455814
495  3/1/1991  5.5459627
479 11/1/1989  2.9728814
538 10/1/1994  1.0039216
371 11/1/1980  0.2333333
710  2/1/2009  6.0247368
600 12/1/1999  4.3933333
577  1/1/1998  1.8638298
803 11/1/2016  5.4050980
156 12/1/1962  0.2500000
294  6/1/1974  3.4092784
606  6/1/2000  1.7794118
565  1/1/1997  2.7460000
570  6/1/1997  1.0589744
349  1/1/1979  2.2750000
328  4/1/1977  3.2340909
603  3/1/2000  1.9009709
428  8/1/1985  2.8854545
369  9/1/1980  1.9783784
249  9/1/1970  3.0196429
375  3/1/1981  4.4828571
476  8/1/1989  1.1583333
666  6/1/2005  1.8820189
239 11/1/1969  1.5000000
323 11/1/1976  3.9101415
693  9/1/2007  2.0867308
604  4/1/2000  4.5029412
329  5/1/1977  4.0099567
415  7/1/1984  2.0458333
527 11/1/1993  1.8473684
154 10/1/1962  1.7545455
766 10/1/2013  4.1280000
188  8/1/1965  1.6311475
545  5/1/1995  3.5215000
609  9/1/2000  3.1851064
> nrow(tornlen)
[1] 804
> test=tornlen(1:30)
Error in tornlen(1:30) : could not find function "tornlen"
> test=tornlen[1:30]
Error in `[.data.frame`(tornlen, 1:30) : undefined columns selected
> test=tornlen[1:30,]
> test
         date  avglength
313  1/1/1976  0.4916667
179 11/1/1964  5.2210526
579  3/1/1998  3.1876712
377  5/1/1981  3.3486631
782  2/1/2015  0.6333333
752  8/1/2012  1.2418421
434  2/1/1986  2.3233333
800  8/1/2016  2.3550000
227 11/1/1968 11.9590909
727  7/1/2010  2.4360959
223  7/1/1968  0.8732143
622 10/1/2001  3.8099174
589  1/1/1999  5.2151376
602  2/1/2000  4.4758621
590  2/1/1999  3.9375000
192 12/1/1965  0.8000000
420 12/1/1984  3.6500000
38   2/1/1953  5.2437500
431 11/1/1985  3.7315789
572  8/1/1997  0.7880952
367  7/1/1980  1.8505263
111  3/1/1959  4.7644444
3    3/1/1950  8.8521739
638  2/1/2003  0.9500000
767 11/1/2013  7.6774390
182  2/1/1965  9.6735294
14   2/1/1951 14.7909091
691  7/1/2007  1.0904348
804 12/1/2016  2.2889474
342  6/1/1978  1.7560000
> test=tornlen[which(date < 2004)]
Error in date < 2004 : 
  comparison (3) is possible only for atomic and list types
> test=tornlen[which(nrow < 40)]
Error in nrow < 40 : 
  comparison (3) is possible only for atomic and list types
> test=tornlen[5:30,]
> test
         date  avglength
782  2/1/2015  0.6333333
752  8/1/2012  1.2418421
434  2/1/1986  2.3233333
800  8/1/2016  2.3550000
227 11/1/1968 11.9590909
727  7/1/2010  2.4360959
223  7/1/1968  0.8732143
622 10/1/2001  3.8099174
589  1/1/1999  5.2151376
602  2/1/2000  4.4758621
590  2/1/1999  3.9375000
192 12/1/1965  0.8000000
420 12/1/1984  3.6500000
38   2/1/1953  5.2437500
431 11/1/1985  3.7315789
572  8/1/1997  0.7880952
367  7/1/1980  1.8505263
111  3/1/1959  4.7644444
3    3/1/1950  8.8521739
638  2/1/2003  0.9500000
767 11/1/2013  7.6774390
182  2/1/1965  9.6735294
14   2/1/1951 14.7909091
691  7/1/2007  1.0904348
804 12/1/2016  2.2889474
342  6/1/1978  1.7560000
> test=tornlents[1:30]
> test
 [1]  0.2000000  4.3550000  1.2791667  3.9899038  2.4892096  5.7393548  2.6327273
 [8]  5.2823377  1.8938596  4.1465116 12.6029412  1.7687500  0.8090909  1.7419355
[15]  2.0307692  0.1000000  1.5891566  4.1788095  7.6421311  1.4106796  2.0338983
[22]  4.7318966 11.4500000  2.8600000  3.5191176  1.5418248 11.9590909  0.2000000
[29]  2.3944444 30.2066667
> test=tornlents[1:30,]
Error in `[.default`(tornlents, 1:30, ) : incorrect number of dimensions
> tornlents
            Jan        Feb        Mar        Apr        May        Jun        Jul
1950  0.2000000  4.3550000  1.2791667  3.9899038  2.4892096  5.7393548  2.6327273
1951  0.8090909  1.7419355  2.0307692  0.1000000  1.5891566  4.1788095  7.6421311
1952  3.5191176  1.5418248 11.9590909  0.2000000  2.3944444 30.2066667  4.4485876
1953  2.4772152 10.3666667  1.1000000  1.8428571  1.5718750  1.6842105  3.1021277
1954  2.1406250  5.1812500  0.4000000  3.6350000  2.9386667  1.3971667  6.9117647
1955 10.7500000  1.5313514  2.7523810  5.5130435  1.5333333  1.8974138  1.5850000
1956  5.2595238  4.7000000  0.8250000 11.2500000  1.6500000  3.0826087  2.3251462
1957  5.7357143  2.6911765  4.9718310  3.7910448  1.3300000  2.7321678  7.0821138
1958  2.5300000  1.4360656  1.5791667  4.0400000  9.5000000  1.7885714  6.2823529
1959  2.0467500 13.4304348  3.9689655  3.3061224  5.2210526  7.6503817  1.0666667
1960  2.5767442  3.3982727  5.5500000  2.5022059  2.9710280  3.6388889  4.2281899
1961  5.0807692  3.9375000  5.2654321  2.7760870  6.6402439  2.5293204 13.3619048
1962  5.8462687  2.1178571  5.7365854  1.8107143  1.5189655  3.3109091  8.2010000
1963  1.2312500  2.3233333  4.4090909  1.2764865  0.8411765  8.9858065  1.3303571
1964  0.4000000  2.1266667  4.1676471  6.3600000  3.1400000  3.9977215  0.8653061
1965  1.6454545  4.6294118  0.3000000  2.4818085  1.5265672  3.5730769  1.6558824
1966  3.0844706  2.0326531  6.0050000  2.0272727 11.9333333  1.8790441  2.9777778
1967  5.2755556  4.3363636  2.8311111  0.7500000  9.6735294  4.9928571  1.2406667
1968  4.7761111  5.2676471  3.5978182  2.8613333  2.8365672  2.6593750  1.1779412
1969  2.0342857  4.7024752  3.4666667  6.4076087  2.3873913  6.5488889  1.1222222
1970  4.9263158  3.8044776  1.2684211  1.5326733  2.8485149  1.9832117  4.5742857
1971  2.4614286  2.9037975  8.8000000  2.0337864  1.5817073  0.9574074  4.4938776
1972  0.3750000  4.1454545  8.9000000  3.8897661  3.0307692  5.0039216  1.3058824
1973  2.0538462  2.8051724  1.0500000  2.4932184  1.9289017  1.5166667  1.0758621
1974  1.5753846  9.5617647  3.3486631  0.9452632  6.4000000  1.1166667  0.3400000
1975  2.0901575  2.9393617  1.5571429  7.6243590  2.7175000  7.1881279  7.6774390
1976  2.2558333  0.3868421  1.7678304  6.7189873  4.5909091  1.0263158  2.5984375
1977 11.1319444 12.7161290  4.8263158  6.6764706  1.7917808  4.4323077  2.6888525
1978  8.8521739  2.5386486  9.7013158  9.0914729  3.8277778  1.4000000  6.4403509
1979  1.1950000  7.6517241  4.2565217  1.8650794  6.5294118  3.3173913  3.1627562
1980  1.3229885  1.3285714  4.0009091  3.5441176 10.7807692  2.2363636  6.9714286
1981  0.7142857  3.6792683  3.8869565  1.5476190  2.9441176  0.9481481  6.8152778
1982  1.1041667  5.8045455 10.5666667  4.2208252  3.2200000  1.0320000 16.6800000
1983 12.9700000  1.2400000  5.8098765  0.9000000 11.5360656  4.2476510  1.8259259
1984  6.0398551  4.1500000  3.1524444  1.1894737  2.0653061  2.3668462  1.2400000
1985  6.1210000  0.8000000  1.3538462  5.9285714  1.4324324  3.6500000  5.8388889
1986  1.9500000  3.4033333  1.9928571  2.2277193  3.1830986  2.6072603  1.3666667
1987  1.0323810  2.6465116  2.6496241  5.7833333  4.5347826 12.4151203  5.2212121
1988  3.7795266  4.9166667  4.3448980 15.1000000  1.2418421  2.5750000  3.4745283
1989  4.5250000  7.8431373  3.3251407  5.4763158  2.1253731  5.7862745  1.3359375
1990  3.3011905  2.7233333  5.2951049  1.3062500  2.1624242  1.5952381  3.1384615
1991  2.0032258  2.5166667  1.9750943  3.7327586  1.5416667  1.3891892 20.4000000
1992  6.3209036  3.2708197  1.5666667  4.4888889  3.2339130 11.5500000  1.7111111
1993  5.4343137  2.1829070  8.0566845  1.3506349 23.1590909  0.2800000  2.8837209
1994  1.7112033 13.1365854  1.3654762  3.9333333  1.3787500  5.7968750  5.5187500
1995  2.2526316 15.4565217  2.6675978  1.8505263  3.6870968  2.7694118  1.7360465
1996  0.6500000  5.3020455  2.3522293  3.8668750  0.8732143  2.6464135  1.2636364
1997  1.1676923  4.7563810  3.9434091  1.4460000  1.1700000  2.1100000  2.3454545
1998  2.7301075  4.6212766  1.3550000  3.1441176  2.5268125  2.2884766  2.7246470
1999  2.8640000  1.4076923  1.0904348  2.0000000  3.1876712 10.1666667  9.6417323
2000  3.4041667  4.9571429  4.5971660  0.8961538  1.0304348  3.7641026  2.1621622
2001  1.7225490  1.4257143  2.8400000  0.8000000  1.2115702  1.5000000  1.8253012
2002  0.3000000  0.7880952  1.3961538  4.7351351  4.2175824  7.3058824  3.2681818
2003  3.6515152  1.4869159  6.6195270  3.4124719  2.9777778  1.4103774  2.9770000
            Aug        Sep        Oct        Nov        Dec
1950  5.2823377  1.8938596  4.1465116 12.6029412  1.7687500
1951  1.4106796  2.0338983  4.7318966 11.4500000  2.8600000
1952  3.3196078  1.9166667  1.5882682  1.1225806  2.8156250
1953  9.1937500  1.7000000  1.1656566  5.4285714  2.9835690
1954  1.3125243  3.1866667  7.7008446  4.2360000  4.8736842
1955  2.2835821  4.9605839  2.2920000  3.3428571  4.0436364
1956  2.9638889  6.5809524  1.4578947  1.7660714  6.4214286
1957  1.5416667  0.5000000  1.7768166  4.5194444 11.2000000
1958  6.9781013  4.3919753  2.5918699  1.3295455  3.6625000
1959  7.6787500  6.0523256  8.9628000 11.0600000  2.2141600
1960  1.2777027  3.1400000  3.4114634  2.7160377  0.5600000
1961  2.4360959  3.1941304  6.6096078  2.7888889  3.3753846
1962  3.4455696  8.8188889  2.9111111  1.8225000  1.5720280
1963  3.1365969  2.7468750  2.0241667  1.9967742  5.6971429
1964  5.9514286  4.0476190  6.5964706  1.9266387  8.6870968
1965  4.5615385  1.6875000  1.0524390  0.9500000  2.1147368
1966  6.3180714  1.1500000  2.0271429  4.9790323  4.4841060
1967  3.0102837  2.0129464  2.5144776  1.1285714  2.3430894
1968  2.3790000 10.1076923  3.3222222  1.7830189  0.8708333
1969  2.1894737  2.5137500  0.9157895  2.7802548  5.2151376
1970  4.9937838  2.3571429  4.9176471  3.4495050  1.8583333
1971  0.9060606  1.4295238  1.2212329  1.3000000  3.2802326
1972  5.5612069  3.5108108  5.2750000  7.3000000  3.5400000
1973  5.0652174  2.0200000  0.2800000  5.4723864  8.4444444
1974  5.1183966  1.4809524  5.4291667  5.7651786  3.4008000
1975  2.2951220  5.5095238  1.2797468  1.8380952  3.9527273
1976 11.0000000  4.0722222  2.4842105  0.4555556  1.9604167
1977  1.5882353  4.9812500  3.8987013  1.9766667  5.4568750
1978  1.5330435  1.4201493  7.1658537  3.7315789  1.8129808
1979  1.6457627  2.5000000  1.7879661  4.8795812  2.9473684
1980  1.4894737  2.7723077  1.1090909  4.0197674  6.8541667
1981  4.6120000  4.1050000  1.9300000  1.8620253  1.1800000
1982  9.7354430  2.1971014  3.2985714  0.7200000  6.2666667
1983  2.0685990  2.5000000  4.8750000  8.0932039  3.0315068
1984  5.1320000  2.0164557  3.9543478  3.9217391  1.6717391
1985  1.8136364  2.5852381  4.2815789  1.3402778  3.5178571
1986  4.9573810  2.9847059  2.2411765  3.6439024  1.7892857
1987  4.6366013  4.3666667  5.7852459  2.9857143  0.9757282
1988  2.3219512  3.8099174  3.9642857  1.1709302  2.5000000
1989  3.8815534  2.2889474  2.8382353  1.4782609  5.7765957
1990  0.1000000  4.0793269  8.7687500  3.4320000  4.5520000
1991  2.5066667  4.5678082  0.7066667  1.7117355  1.0500000
1992  2.4201826  8.5428571  3.6082558  3.1803653  2.9287037
1993  2.4557143  2.3850000  7.4973684  2.2384615  1.2760000
1994  3.7800000  8.7152542  3.8554945  5.2545455  1.8641509
1995  1.9101695  1.3555556  0.6126984  5.2060440  7.7800000
1996  3.2538462  1.6748387  5.8157407 29.5000000  3.8750000
1997  0.5300000  4.4703053  1.9262295  2.8984848  2.5000000
1998  4.1000000  3.5200000 14.7909091  2.7964103  9.6687500
1999  1.1928571  4.2176471  9.8000000  0.6235294  1.8000000
2000  2.2545455  4.2131148  1.2000000 13.5500000  5.8552632
2001  3.1789474 11.0818182  2.5000000  1.8571429  5.3106667
2002  6.5166667  3.5036232  2.7438642  2.9184874  1.0000000
2003                                                       
> trytest=tornlents[1,648]
Error in `[.default`(tornlents, 1, 648) : incorrect number of dimensions
> trytest=tornlents[1:648]
> trytrain=tornlents[1:648]
> trytest=tornlents[649:156]
> trytrain
  [1]  0.2000000  4.3550000  1.2791667  3.9899038  2.4892096  5.7393548  2.6327273
  [8]  5.2823377  1.8938596  4.1465116 12.6029412  1.7687500  0.8090909  1.7419355
 [15]  2.0307692  0.1000000  1.5891566  4.1788095  7.6421311  1.4106796  2.0338983
 [22]  4.7318966 11.4500000  2.8600000  3.5191176  1.5418248 11.9590909  0.2000000
 [29]  2.3944444 30.2066667  4.4485876  3.3196078  1.9166667  1.5882682  1.1225806
 [36]  2.8156250  2.4772152 10.3666667  1.1000000  1.8428571  1.5718750  1.6842105
 [43]  3.1021277  9.1937500  1.7000000  1.1656566  5.4285714  2.9835690  2.1406250
 [50]  5.1812500  0.4000000  3.6350000  2.9386667  1.3971667  6.9117647  1.3125243
 [57]  3.1866667  7.7008446  4.2360000  4.8736842 10.7500000  1.5313514  2.7523810
 [64]  5.5130435  1.5333333  1.8974138  1.5850000  2.2835821  4.9605839  2.2920000
 [71]  3.3428571  4.0436364  5.2595238  4.7000000  0.8250000 11.2500000  1.6500000
 [78]  3.0826087  2.3251462  2.9638889  6.5809524  1.4578947  1.7660714  6.4214286
 [85]  5.7357143  2.6911765  4.9718310  3.7910448  1.3300000  2.7321678  7.0821138
 [92]  1.5416667  0.5000000  1.7768166  4.5194444 11.2000000  2.5300000  1.4360656
 [99]  1.5791667  4.0400000  9.5000000  1.7885714  6.2823529  6.9781013  4.3919753
[106]  2.5918699  1.3295455  3.6625000  2.0467500 13.4304348  3.9689655  3.3061224
[113]  5.2210526  7.6503817  1.0666667  7.6787500  6.0523256  8.9628000 11.0600000
[120]  2.2141600  2.5767442  3.3982727  5.5500000  2.5022059  2.9710280  3.6388889
[127]  4.2281899  1.2777027  3.1400000  3.4114634  2.7160377  0.5600000  5.0807692
[134]  3.9375000  5.2654321  2.7760870  6.6402439  2.5293204 13.3619048  2.4360959
[141]  3.1941304  6.6096078  2.7888889  3.3753846  5.8462687  2.1178571  5.7365854
[148]  1.8107143  1.5189655  3.3109091  8.2010000  3.4455696  8.8188889  2.9111111
[155]  1.8225000  1.5720280  1.2312500  2.3233333  4.4090909  1.2764865  0.8411765
[162]  8.9858065  1.3303571  3.1365969  2.7468750  2.0241667  1.9967742  5.6971429
[169]  0.4000000  2.1266667  4.1676471  6.3600000  3.1400000  3.9977215  0.8653061
[176]  5.9514286  4.0476190  6.5964706  1.9266387  8.6870968  1.6454545  4.6294118
[183]  0.3000000  2.4818085  1.5265672  3.5730769  1.6558824  4.5615385  1.6875000
[190]  1.0524390  0.9500000  2.1147368  3.0844706  2.0326531  6.0050000  2.0272727
[197] 11.9333333  1.8790441  2.9777778  6.3180714  1.1500000  2.0271429  4.9790323
[204]  4.4841060  5.2755556  4.3363636  2.8311111  0.7500000  9.6735294  4.9928571
[211]  1.2406667  3.0102837  2.0129464  2.5144776  1.1285714  2.3430894  4.7761111
[218]  5.2676471  3.5978182  2.8613333  2.8365672  2.6593750  1.1779412  2.3790000
[225] 10.1076923  3.3222222  1.7830189  0.8708333  2.0342857  4.7024752  3.4666667
[232]  6.4076087  2.3873913  6.5488889  1.1222222  2.1894737  2.5137500  0.9157895
[239]  2.7802548  5.2151376  4.9263158  3.8044776  1.2684211  1.5326733  2.8485149
[246]  1.9832117  4.5742857  4.9937838  2.3571429  4.9176471  3.4495050  1.8583333
[253]  2.4614286  2.9037975  8.8000000  2.0337864  1.5817073  0.9574074  4.4938776
[260]  0.9060606  1.4295238  1.2212329  1.3000000  3.2802326  0.3750000  4.1454545
[267]  8.9000000  3.8897661  3.0307692  5.0039216  1.3058824  5.5612069  3.5108108
[274]  5.2750000  7.3000000  3.5400000  2.0538462  2.8051724  1.0500000  2.4932184
[281]  1.9289017  1.5166667  1.0758621  5.0652174  2.0200000  0.2800000  5.4723864
[288]  8.4444444  1.5753846  9.5617647  3.3486631  0.9452632  6.4000000  1.1166667
[295]  0.3400000  5.1183966  1.4809524  5.4291667  5.7651786  3.4008000  2.0901575
[302]  2.9393617  1.5571429  7.6243590  2.7175000  7.1881279  7.6774390  2.2951220
[309]  5.5095238  1.2797468  1.8380952  3.9527273  2.2558333  0.3868421  1.7678304
[316]  6.7189873  4.5909091  1.0263158  2.5984375 11.0000000  4.0722222  2.4842105
[323]  0.4555556  1.9604167 11.1319444 12.7161290  4.8263158  6.6764706  1.7917808
[330]  4.4323077  2.6888525  1.5882353  4.9812500  3.8987013  1.9766667  5.4568750
[337]  8.8521739  2.5386486  9.7013158  9.0914729  3.8277778  1.4000000  6.4403509
[344]  1.5330435  1.4201493  7.1658537  3.7315789  1.8129808  1.1950000  7.6517241
[351]  4.2565217  1.8650794  6.5294118  3.3173913  3.1627562  1.6457627  2.5000000
[358]  1.7879661  4.8795812  2.9473684  1.3229885  1.3285714  4.0009091  3.5441176
[365] 10.7807692  2.2363636  6.9714286  1.4894737  2.7723077  1.1090909  4.0197674
[372]  6.8541667  0.7142857  3.6792683  3.8869565  1.5476190  2.9441176  0.9481481
[379]  6.8152778  4.6120000  4.1050000  1.9300000  1.8620253  1.1800000  1.1041667
[386]  5.8045455 10.5666667  4.2208252  3.2200000  1.0320000 16.6800000  9.7354430
[393]  2.1971014  3.2985714  0.7200000  6.2666667 12.9700000  1.2400000  5.8098765
[400]  0.9000000 11.5360656  4.2476510  1.8259259  2.0685990  2.5000000  4.8750000
[407]  8.0932039  3.0315068  6.0398551  4.1500000  3.1524444  1.1894737  2.0653061
[414]  2.3668462  1.2400000  5.1320000  2.0164557  3.9543478  3.9217391  1.6717391
[421]  6.1210000  0.8000000  1.3538462  5.9285714  1.4324324  3.6500000  5.8388889
[428]  1.8136364  2.5852381  4.2815789  1.3402778  3.5178571  1.9500000  3.4033333
[435]  1.9928571  2.2277193  3.1830986  2.6072603  1.3666667  4.9573810  2.9847059
[442]  2.2411765  3.6439024  1.7892857  1.0323810  2.6465116  2.6496241  5.7833333
[449]  4.5347826 12.4151203  5.2212121  4.6366013  4.3666667  5.7852459  2.9857143
[456]  0.9757282  3.7795266  4.9166667  4.3448980 15.1000000  1.2418421  2.5750000
[463]  3.4745283  2.3219512  3.8099174  3.9642857  1.1709302  2.5000000  4.5250000
[470]  7.8431373  3.3251407  5.4763158  2.1253731  5.7862745  1.3359375  3.8815534
[477]  2.2889474  2.8382353  1.4782609  5.7765957  3.3011905  2.7233333  5.2951049
[484]  1.3062500  2.1624242  1.5952381  3.1384615  0.1000000  4.0793269  8.7687500
[491]  3.4320000  4.5520000  2.0032258  2.5166667  1.9750943  3.7327586  1.5416667
[498]  1.3891892 20.4000000  2.5066667  4.5678082  0.7066667  1.7117355  1.0500000
[505]  6.3209036  3.2708197  1.5666667  4.4888889  3.2339130 11.5500000  1.7111111
[512]  2.4201826  8.5428571  3.6082558  3.1803653  2.9287037  5.4343137  2.1829070
[519]  8.0566845  1.3506349 23.1590909  0.2800000  2.8837209  2.4557143  2.3850000
[526]  7.4973684  2.2384615  1.2760000  1.7112033 13.1365854  1.3654762  3.9333333
[533]  1.3787500  5.7968750  5.5187500  3.7800000  8.7152542  3.8554945  5.2545455
[540]  1.8641509  2.2526316 15.4565217  2.6675978  1.8505263  3.6870968  2.7694118
[547]  1.7360465  1.9101695  1.3555556  0.6126984  5.2060440  7.7800000  0.6500000
[554]  5.3020455  2.3522293  3.8668750  0.8732143  2.6464135  1.2636364  3.2538462
[561]  1.6748387  5.8157407 29.5000000  3.8750000  1.1676923  4.7563810  3.9434091
[568]  1.4460000  1.1700000  2.1100000  2.3454545  0.5300000  4.4703053  1.9262295
[575]  2.8984848  2.5000000  2.7301075  4.6212766  1.3550000  3.1441176  2.5268125
[582]  2.2884766  2.7246470  4.1000000  3.5200000 14.7909091  2.7964103  9.6687500
[589]  2.8640000  1.4076923  1.0904348  2.0000000  3.1876712 10.1666667  9.6417323
[596]  1.1928571  4.2176471  9.8000000  0.6235294  1.8000000  3.4041667  4.9571429
[603]  4.5971660  0.8961538  1.0304348  3.7641026  2.1621622  2.2545455  4.2131148
[610]  1.2000000 13.5500000  5.8552632  1.7225490  1.4257143  2.8400000  0.8000000
[617]  1.2115702  1.5000000  1.8253012  3.1789474 11.0818182  2.5000000  1.8571429
[624]  5.3106667  0.3000000  0.7880952  1.3961538  4.7351351  4.2175824  7.3058824
[631]  3.2681818  6.5166667  3.5036232  2.7438642  2.9184874  1.0000000  3.6515152
[638]  1.4869159  6.6195270  3.4124719  2.9777778  1.4103774  2.9770000         NA
[645]         NA         NA         NA         NA
> trytest
  [1]         NA         NA         NA         NA         NA         NA  2.9770000
  [8]  1.4103774  2.9777778  3.4124719  6.6195270  1.4869159  3.6515152  1.0000000
 [15]  2.9184874  2.7438642  3.5036232  6.5166667  3.2681818  7.3058824  4.2175824
 [22]  4.7351351  1.3961538  0.7880952  0.3000000  5.3106667  1.8571429  2.5000000
 [29] 11.0818182  3.1789474  1.8253012  1.5000000  1.2115702  0.8000000  2.8400000
 [36]  1.4257143  1.7225490  5.8552632 13.5500000  1.2000000  4.2131148  2.2545455
 [43]  2.1621622  3.7641026  1.0304348  0.8961538  4.5971660  4.9571429  3.4041667
 [50]  1.8000000  0.6235294  9.8000000  4.2176471  1.1928571  9.6417323 10.1666667
 [57]  3.1876712  2.0000000  1.0904348  1.4076923  2.8640000  9.6687500  2.7964103
 [64] 14.7909091  3.5200000  4.1000000  2.7246470  2.2884766  2.5268125  3.1441176
 [71]  1.3550000  4.6212766  2.7301075  2.5000000  2.8984848  1.9262295  4.4703053
 [78]  0.5300000  2.3454545  2.1100000  1.1700000  1.4460000  3.9434091  4.7563810
 [85]  1.1676923  3.8750000 29.5000000  5.8157407  1.6748387  3.2538462  1.2636364
 [92]  2.6464135  0.8732143  3.8668750  2.3522293  5.3020455  0.6500000  7.7800000
 [99]  5.2060440  0.6126984  1.3555556  1.9101695  1.7360465  2.7694118  3.6870968
[106]  1.8505263  2.6675978 15.4565217  2.2526316  1.8641509  5.2545455  3.8554945
[113]  8.7152542  3.7800000  5.5187500  5.7968750  1.3787500  3.9333333  1.3654762
[120] 13.1365854  1.7112033  1.2760000  2.2384615  7.4973684  2.3850000  2.4557143
[127]  2.8837209  0.2800000 23.1590909  1.3506349  8.0566845  2.1829070  5.4343137
[134]  2.9287037  3.1803653  3.6082558  8.5428571  2.4201826  1.7111111 11.5500000
[141]  3.2339130  4.4888889  1.5666667  3.2708197  6.3209036  1.0500000  1.7117355
[148]  0.7066667  4.5678082  2.5066667 20.4000000  1.3891892  1.5416667  3.7327586
[155]  1.9750943  2.5166667  2.0032258  4.5520000  3.4320000  8.7687500  4.0793269
[162]  0.1000000  3.1384615  1.5952381  2.1624242  1.3062500  5.2951049  2.7233333
[169]  3.3011905  5.7765957  1.4782609  2.8382353  2.2889474  3.8815534  1.3359375
[176]  5.7862745  2.1253731  5.4763158  3.3251407  7.8431373  4.5250000  2.5000000
[183]  1.1709302  3.9642857  3.8099174  2.3219512  3.4745283  2.5750000  1.2418421
[190] 15.1000000  4.3448980  4.9166667  3.7795266  0.9757282  2.9857143  5.7852459
[197]  4.3666667  4.6366013  5.2212121 12.4151203  4.5347826  5.7833333  2.6496241
[204]  2.6465116  1.0323810  1.7892857  3.6439024  2.2411765  2.9847059  4.9573810
[211]  1.3666667  2.6072603  3.1830986  2.2277193  1.9928571  3.4033333  1.9500000
[218]  3.5178571  1.3402778  4.2815789  2.5852381  1.8136364  5.8388889  3.6500000
[225]  1.4324324  5.9285714  1.3538462  0.8000000  6.1210000  1.6717391  3.9217391
[232]  3.9543478  2.0164557  5.1320000  1.2400000  2.3668462  2.0653061  1.1894737
[239]  3.1524444  4.1500000  6.0398551  3.0315068  8.0932039  4.8750000  2.5000000
[246]  2.0685990  1.8259259  4.2476510 11.5360656  0.9000000  5.8098765  1.2400000
[253] 12.9700000  6.2666667  0.7200000  3.2985714  2.1971014  9.7354430 16.6800000
[260]  1.0320000  3.2200000  4.2208252 10.5666667  5.8045455  1.1041667  1.1800000
[267]  1.8620253  1.9300000  4.1050000  4.6120000  6.8152778  0.9481481  2.9441176
[274]  1.5476190  3.8869565  3.6792683  0.7142857  6.8541667  4.0197674  1.1090909
[281]  2.7723077  1.4894737  6.9714286  2.2363636 10.7807692  3.5441176  4.0009091
[288]  1.3285714  1.3229885  2.9473684  4.8795812  1.7879661  2.5000000  1.6457627
[295]  3.1627562  3.3173913  6.5294118  1.8650794  4.2565217  7.6517241  1.1950000
[302]  1.8129808  3.7315789  7.1658537  1.4201493  1.5330435  6.4403509  1.4000000
[309]  3.8277778  9.0914729  9.7013158  2.5386486  8.8521739  5.4568750  1.9766667
[316]  3.8987013  4.9812500  1.5882353  2.6888525  4.4323077  1.7917808  6.6764706
[323]  4.8263158 12.7161290 11.1319444  1.9604167  0.4555556  2.4842105  4.0722222
[330] 11.0000000  2.5984375  1.0263158  4.5909091  6.7189873  1.7678304  0.3868421
[337]  2.2558333  3.9527273  1.8380952  1.2797468  5.5095238  2.2951220  7.6774390
[344]  7.1881279  2.7175000  7.6243590  1.5571429  2.9393617  2.0901575  3.4008000
[351]  5.7651786  5.4291667  1.4809524  5.1183966  0.3400000  1.1166667  6.4000000
[358]  0.9452632  3.3486631  9.5617647  1.5753846  8.4444444  5.4723864  0.2800000
[365]  2.0200000  5.0652174  1.0758621  1.5166667  1.9289017  2.4932184  1.0500000
[372]  2.8051724  2.0538462  3.5400000  7.3000000  5.2750000  3.5108108  5.5612069
[379]  1.3058824  5.0039216  3.0307692  3.8897661  8.9000000  4.1454545  0.3750000
[386]  3.2802326  1.3000000  1.2212329  1.4295238  0.9060606  4.4938776  0.9574074
[393]  1.5817073  2.0337864  8.8000000  2.9037975  2.4614286  1.8583333  3.4495050
[400]  4.9176471  2.3571429  4.9937838  4.5742857  1.9832117  2.8485149  1.5326733
[407]  1.2684211  3.8044776  4.9263158  5.2151376  2.7802548  0.9157895  2.5137500
[414]  2.1894737  1.1222222  6.5488889  2.3873913  6.4076087  3.4666667  4.7024752
[421]  2.0342857  0.8708333  1.7830189  3.3222222 10.1076923  2.3790000  1.1779412
[428]  2.6593750  2.8365672  2.8613333  3.5978182  5.2676471  4.7761111  2.3430894
[435]  1.1285714  2.5144776  2.0129464  3.0102837  1.2406667  4.9928571  9.6735294
[442]  0.7500000  2.8311111  4.3363636  5.2755556  4.4841060  4.9790323  2.0271429
[449]  1.1500000  6.3180714  2.9777778  1.8790441 11.9333333  2.0272727  6.0050000
[456]  2.0326531  3.0844706  2.1147368  0.9500000  1.0524390  1.6875000  4.5615385
[463]  1.6558824  3.5730769  1.5265672  2.4818085  0.3000000  4.6294118  1.6454545
[470]  8.6870968  1.9266387  6.5964706  4.0476190  5.9514286  0.8653061  3.9977215
[477]  3.1400000  6.3600000  4.1676471  2.1266667  0.4000000  5.6971429  1.9967742
[484]  2.0241667  2.7468750  3.1365969  1.3303571  8.9858065  0.8411765  1.2764865
[491]  4.4090909  2.3233333  1.2312500  1.5720280
> accuracy(forecast(modelAR10d1))
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
> diffModelAR10=arima(tornlents,c(10,1,0))
> diffModelAR10

Call:
arima(x = tornlents, order = c(10, 1, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540
         ar10
      -0.1151
s.e.   0.0393

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3415.97
> modelAR10d1

Call:
arima(x = tornlents, order = c(10, 1, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540
         ar10
      -0.1151
s.e.   0.0393

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3415.97
> #build first differencing AR(10) model
> diffModelAR10=arima(tornlents,c(10,1,0))
> #build first differencing MA(1) model
> diffModelMA1 = arima(tornlents,c(0,1,1))
> #view the differenced models
> 
> diffModelAR10

Call:
arima(x = tornlents, order = c(10, 1, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540
         ar10
      -0.1151
s.e.   0.0393

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3415.97
> diffModelMA11
Error: object 'diffModelMA11' not found
> diffModelMA1

Call:
arima(x = tornlents, order = c(0, 1, 1))

Coefficients:
          ma1
      -1.0000
s.e.   0.0047

sigma^2 estimated as 10.79:  log likelihood = -1677.63,  aic = 3359.26
> #residuals analysis of these models
> 
> 
> diffAR10residuals = diffModelAR10$residuals
> diffMA1residuals = diffModelMA1$residuals
> tsdiag(diffModelAR10)
> 
> 
> #normality tests
> 
> jarque.bera.test(diffAR10residuals)

        Jarque Bera Test

data:  diffAR10residuals
X-squared = 4839.7, df = 2, p-value < 2.2e-16

> qqnorm(diffAR10residuals)
> qqline(coredata(diffAR10residuals))
> #residual analysis of diffModelMA1
> 
> 
> tsdiag(diffModelMA1)
> 
> 
> #normality tests
> 
> qqline(coredata(diffMA1residuals))
> jarque.bera.test(diffMA1residuals)

        Jarque Bera Test

data:  diffMA1residuals
X-squared = 6774.3, df = 2, p-value < 2.2e-16

> qqnorm(diffMA1residuals)
> qqline(coredata(diffMA1residuals))
> 
> 
> 
> #Ljung box tests for white noise of residuals
> 
> 
> Box.test(coredata(diffAR10residuals),lag=12,type='Ljung')

        Box-Ljung test

data:  coredata(diffAR10residuals)
X-squared = 15.065, df = 12, p-value = 0.2379

> Box.test(coredata(diffAR10residuals),lag=18,type='Ljung')

        Box-Ljung test

data:  coredata(diffAR10residuals)
X-squared = 19.594, df = 18, p-value = 0.3561

> Box.test(coredata(diffMA1residuals),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(diffMA1residuals)
X-squared = 4.06, df = 6, p-value = 0.6686

> Box.test(coredata(diffMA1residuals),lag=12,type='Ljung')

        Box-Ljung test

data:  coredata(diffMA1residuals)
X-squared = 10.953, df = 12, p-value = 0.5329

> start(tornlents)
[1] 1950    1
> end(tornlents)
[1] 2003    7
> start(testlents)
[1] 2004    1
> end(testlents)
[1] 2017    5
> preddiffAR10 = predict(diffModelAR10,n.ahead=36)
> plot(tornlents,2
+ .718)
Error: unexpected numeric constant in:
"plot(tornlents,2
.718"
> plot(tornlents,2.718^preddiffAR10$pred,lty=c(1,3)
+ )
Error in plot.window(...) : need finite 'xlim' values
In addition: Warning messages:
1: In .cbind.ts(list(...), .makeNamesTs(...), dframe = dframe, union = FALSE) :
  non-intersecting series
2: In min(x) : no non-missing arguments to min; returning Inf
3: In max(x) : no non-missing arguments to max; returning -Inf
4: In min(x) : no non-missing arguments to min; returning Inf
5: In max(x) : no non-missing arguments to max; returning -Inf
> ts.plot(tornlents,2.718^preddiffAR10$pred,lty=c(1,3)
+ )
> ts.plot(tornlentsdiff,2.718^preddiffAR10$pred,lty=c(1,3),col='red')
> accuracy(forecast(diffModelAR10),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
Test set     1.523244020 3.856371 2.527493 -36.43349  87.5829 0.8206137 -0.164305757
             Theil's U
Training set        NA
Test set      1.032556
> accuracy(forecast(diffModelMA1),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE        ACF1
Training set -0.00242915 3.281757 2.229157 -88.27413 113.6255 0.7237512 -0.04630433
Test set      0.64994562 3.584720 2.417801 -73.28311 106.1385 0.7849994 -0.16970262
             Theil's U
Training set        NA
Test set      1.100649
> accuracy(forecast(modelARMA12),testlents)
Error in is.constant(y) : 
  (list) object cannot be coerced to type 'double'
> accuracy(forecast(diffModelMA1),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE        ACF1
Training set -0.00242915 3.281757 2.229157 -88.27413 113.6255 0.7237512 -0.04630433
Test set      0.64994562 3.584720 2.417801 -73.28311 106.1385 0.7849994 -0.16970262
             Theil's U
Training set        NA
Test set      1.100649
> accuracy(testlents)
Error in accuracy.default(testlents) : 
  Unable to compute forecast accuracy measures
> accuracy(forecast(testlents))
                      ME     RMSE      MAE       MPE     MAPE      MASE       ACF1
Training set -0.03785336 2.381773 1.757026 -98.03784 125.9628 0.7045034 -0.1204011
> help("accuracy")
> modelTestMA1 = arima(testlents,c(0,1,1))
Warning message:
In file(out, "wt") :
  cannot open file 'C:\Users\archa\AppData\Local\Temp\Rtmp4c7qQ9\Rhttpd35e037a45d22': No such file or directory
> modelTestMA1 = arima(testlents,c(0,1,1))
> accuracy(forecast(modelTestMA1))
                     ME     RMSE      MAE      MPE     MAPE      MASE        ACF1
Training set 0.02283528 2.592858 1.931583 -108.535 138.6622 0.7744944 -0.08830331
> plot(forecast(diffModelMA1))
> plot(forecast(diffModelMA1),48)
> plot(forecast(diffModelMA1),144)
> 
> 
> 
> 
> diffARMAmodel12 = arima(tornlents,c(1,1,2))
> diffARMAmodel12

Call:
arima(x = tornlents, order = c(1, 1, 2))

Coefficients:
         ar1      ma1     ma2
      0.7056  -1.7585  0.7585
s.e.  0.2401   0.2238  0.2240

sigma^2 estimated as 10.72:  log likelihood = -1675.88,  aic = 3359.76
> accuracy(forecast(diffARMAmodel12),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set -0.01083593 3.271790 2.219422 -88.31711 113.4764 0.7205905  0.001686877
Test set      0.64179524 3.587062 2.420790 -74.02362 106.7822 0.7859699 -0.167669894
             Theil's U
Training set        NA
Test set      1.105527
> forecast(diffModelAR10,10)
         Point Forecast      Lo 80    Hi 80     Lo 95     Hi 95
Aug 2003       2.853546 -1.4997363 7.206829 -3.804225  9.511317
Sep 2003       2.775261 -1.5812408 7.131763 -3.887434  9.437956
Oct 2003       2.825593 -1.5372596 7.188446 -3.846814  9.498001
Nov 2003       2.983553 -1.4010963 7.368202 -3.722189  9.689295
Dec 2003       3.468052 -0.9319463 7.868051 -3.261165 10.197270
Jan 2004       3.069170 -1.3486083 7.486949 -3.687239  9.825580
Feb 2004       3.188793 -1.2516060 7.629192 -3.602211  9.979797
Mar 2004       2.781775 -1.6772084 7.240758 -4.037651  9.601201
Apr 2004       2.852125 -1.6829376 7.387188 -4.083655  9.787905
May 2004       2.784457 -1.8555435 7.424457 -4.311811  9.880725
> predict(diffmodelAR10,n.ahead=10)
Error in predict(diffmodelAR10, n.ahead = 10) : 
  object 'diffmodelAR10' not found
> predict(diffModelAR10,n.ahead=10)
$pred
          Jan      Feb      Mar      Apr      May Jun Jul      Aug      Sep      Oct
2003                                                      2.853546 2.775261 2.825593
2004 3.069170 3.188793 2.781775 2.852125 2.784457                                   
          Nov      Dec
2003 2.983553 3.468052
2004                  

$se
          Jan      Feb      Mar      Apr      May Jun Jul      Aug      Sep      Oct
2003                                                      3.396884 3.399397 3.404352
2004 3.447211 3.464862 3.479363 3.538728 3.620612                                   
          Nov      Dec
2003 3.421360 3.433337
2004                  

> forecastresults=forecast(diffModelAR10,10)
> forecastresults$Forecast
NULL
> forecastresults[,2]
Error in forecastresults[, 2] : incorrect number of dimensions
> forecastresults
         Point Forecast      Lo 80    Hi 80     Lo 95     Hi 95
Aug 2003       2.853546 -1.4997363 7.206829 -3.804225  9.511317
Sep 2003       2.775261 -1.5812408 7.131763 -3.887434  9.437956
Oct 2003       2.825593 -1.5372596 7.188446 -3.846814  9.498001
Nov 2003       2.983553 -1.4010963 7.368202 -3.722189  9.689295
Dec 2003       3.468052 -0.9319463 7.868051 -3.261165 10.197270
Jan 2004       3.069170 -1.3486083 7.486949 -3.687239  9.825580
Feb 2004       3.188793 -1.2516060 7.629192 -3.602211  9.979797
Mar 2004       2.781775 -1.6772084 7.240758 -4.037651  9.601201
Apr 2004       2.852125 -1.6829376 7.387188 -4.083655  9.787905
May 2004       2.784457 -1.8555435 7.424457 -4.311811  9.880725
> 
> 
> 
> 
> 
> #Since ARMA model cannot be used for prediction using the p,q values from EACF plot to build abother model
> 
> 
> diffModelARMA12 = arima(tornlents,c(1,1,2))
> 
> 
> #view the new ARMA model
> 
> 
> diffModelARMA12

Call:
arima(x = tornlents, order = c(1, 1, 2))

Coefficients:
         ar1      ma1     ma2
      0.7056  -1.7585  0.7585
s.e.  0.2401   0.2238  0.2240

sigma^2 estimated as 10.72:  log likelihood = -1675.88,  aic = 3359.76
> 
> #residual analysis of new ARMA model
> 
> 
> diffarma12residuals = diffModelARMA12$residuals
> 
> 
> 
> #residual plots
> 
> tsdiag(diffModelARMA12)
> 
> 
> #qqplot
> qqnorm(coredata(diffarma12residuals))
> qqline(coredata(diffarma12residuals),col=3)
> 
> #jarque bera test for normality
> jarque.bera.test(coredata(diffarma12residuals))

        Jarque Bera Test

data:  coredata(diffarma12residuals)
X-squared = 6802.3, df = 2, p-value < 2.2e-16

> 
> 
> #Ljung box test for residuals white noise
> 
> 
> Box.test(coredata(diffarma12residuals),lag=6,type='Ljung')

        Box-Ljung test

data:  coredata(diffarma12residuals)
X-squared = 0.84713, df = 6, p-value = 0.9908

> Box.test(coredata(diffarma12residuals),lag=12,type='Ljung')

        Box-Ljung test

data:  coredata(diffarma12residuals)
X-squared = 7.7095, df = 12, p-value = 0.8074

> 
> 
> #creating time series object for the test data
> 
> 
> testlents=ts(testlen,start=2004,end=2016,frequency=12)
> 
> 
> testlents
            Jan        Feb        Mar        Apr        May        Jun        Jul
2004  0.4916667  0.6333333  2.3550000  4.4758621  5.2437500  4.7644444  1.7560000
2005  2.6583333  3.7692308 10.8437500  2.9692308  2.0214286 15.0000000  3.6269231
2006  2.1398990  2.2452675  1.7444444  0.4500000  2.3166667  1.0129496  1.0000000
2007  0.6115385  0.5811321  0.1000000  2.1125000  3.5500000  1.4657895  0.8285714
2008  1.0500000  1.0710145  1.9098039  2.7732000  4.3410714  2.4410256  2.1242152
2009  1.3578947  1.8028169  4.4500000  2.3952419  8.5448980  3.3777778  7.5393939
2010  6.1681818  0.7823529  4.3561728  6.3234375  3.2015075  5.6214286  2.7708333
2011  2.7111111  2.8117647  6.5168367  2.6846667  6.7787037  6.7644444  0.7956522
2012  1.0000000  0.5765957  1.0113636  7.3888889  3.6000000  1.7960000  1.4285714
2013  1.4269231  2.3568047  0.1000000  5.0285714  0.8793103  5.4676667  1.2333333
2014  2.8900000  2.2333333  4.9523256  2.6573574  3.0000000  7.0857143  1.4455814
2015  4.3933333  1.8638298  5.4050980  0.2500000  3.4092784  1.7794118  2.7460000
2016  1.9783784                                                                  
            Aug        Sep        Oct        Nov        Dec
2004  4.5815126  1.4593750  6.6500000  3.6302158  8.2500000
2005  1.5041237  3.7000000  1.2641667  3.3600000  1.7285714
2006  4.2666667  2.3026316  2.9256000  1.8250000  2.7900923
2007  4.0055556  5.1666667  3.0928571  1.6666667  2.3175439
2008  2.2605357  2.2366667  2.4270000  1.0285714  4.9965517
2009  1.1642857  5.2402844  4.3857143  3.3377778  1.2086842
2010  3.2666667 11.2088889  7.5370000  3.7375000  3.1839506
2011  5.5937500  9.4285714  1.3069697  1.0000000 16.8347826
2012  0.8319444  1.0222222  0.8333333  2.9666667  6.5954545
2013  4.5842593  2.4565217  6.7611429  7.5870000  6.4432184
2014  5.5459627  2.9728814  1.0039216  0.2333333  6.0247368
2015  1.0589744  2.2750000  3.2340909  1.9009709  2.8854545
2016                                                       
> 
> 
> #evalutating the built AR, MA and ARMA models based using test data
> 
> 
> #accuracy of AR10 model
> 
> accuracy(forecast(diffModelAR10),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
Test set     1.523244020 3.856371 2.527493 -36.43349  87.5829 0.8206137 -0.164305757
             Theil's U
Training set        NA
Test set      1.032556
> 
> 
> #accuracy of MA1 model
> 
> accuracy(forecast(diffModelMA1),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE        ACF1
Training set -0.00242915 3.281757 2.229157 -88.27413 113.6255 0.7237512 -0.04630433
Test set      0.64994562 3.584720 2.417801 -73.28311 106.1385 0.7849994 -0.16970262
             Theil's U
Training set        NA
Test set      1.100649
> 
> 
> 
> #accuracy of ARMA(1,2) model
> 
> accuracy(forecast(diffModelARMA12),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set -0.01083593 3.271790 2.219422 -88.31711 113.4764 0.7205905  0.001686877
Test set      0.64179524 3.587062 2.420790 -74.02362 106.7822 0.7859699 -0.167669894
             Theil's U
Training set        NA
Test set      1.105527
> 
> 
> 
> #compute and plot predictions
> 
> 
> 
> #predictions and plots for MA1 model
> 
> 
> x.fore=predict(diffModelMA1,n.ahead=108)
> #plotting the forecasts now
> 
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx = min(tornlents,L)
> maxx = max(tornlents,U)
> ts.plot(tornlents,x.fore$pred,col=1:2,ylim=c(minx.maxx))
Error in ts.plot(tornlents, x.fore$pred, col = 1:2, ylim = c(minx.maxx)) : 
  object 'minx.maxx' not found
> ts.plot(tornlents,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> minx = min(tornlentsdiff,L)
> maxx = max(tornlentsdiff,U)
> ts.plot(tornlentsdiff,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> lines(U,col="blue",lty="dashed")
> lines(L,col="blue",lwd=2,lty="dashed")
> x.fore=predict(diffModelAR10,n.ahead=108)
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx = min(tornlentsdiff,L)
> maxx = max(tornlentsdiff,U)
> ts.plot(tornlentsdiff,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> lines(U,col="blue",lty="dashed", lwd=2)
> lines(L,col="blue",lty="dashed", lwd=2)
> x.fore=predict(diffModelMA1,n.ahead=240)
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx = min(tornlents,L)
> maxx = max(tornlents,U)
> ts.plot(tornlentsdiff,x.fore$pred,col=1:2,ylim=c(mix,maxx))
Error in ts.plot(tornlentsdiff, x.fore$pred, col = 1:2, ylim = c(mix,  : 
  object 'mix' not found
> ts.plot(tornlentsdiff,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> ts.plot(tornlents,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> x.fore=predict(diffModelAR10,n.ahead=120)
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx = min(tornlents,L)
> maxx = max(tornlents,U)
> ts.plot(tornlentsdiff,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> lines(U,col="blue",lty="dashed", lwd=2)
> lines(L,col="blue",lty="dashed", lwd=2)
> x.fore=predict(diffModelMA1,n.ahead=108)
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx = min(tornlents,L)
> maxx = max(tornlents,U)
> ts.plot(tornlentsdiff,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> lines(U,col="blue",lty="dashed", lwd=2)
> lines(L,col="blue",lty="dashed", lwd=2)
> x.fore=predict(diffModelMA1,n.ahead=108)
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx = min(tornlents,L)
> maxx = max(tornlents,U)
> ts.plot(tornlents,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> lines(U,col="blue",lty="dashed", lwd=2)
> lines(L,col="blue",lty="dashed", lwd=2)
> 
> 
> forecast(diffModelMA1)
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
> forecast(diffModelMA1,36)
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
> forecast(diffModelMA1,48)
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
> forecast(diffModelMA1,200)
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2003       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2004       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2005       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2006       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2007       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2008       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2009       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2010       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2011       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2012       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2013       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2014       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2015       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2016       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2017       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2018       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Apr 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
May 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jun 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jul 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Aug 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Sep 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Oct 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Nov 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Dec 2019       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Jan 2020       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Feb 2020       3.833215 -0.3790714 8.045502 -2.608921 10.27535
Mar 2020       3.833215 -0.3790714 8.045502 -2.608921 10.27535
> forecast(diffModelAR10,50)
         Point Forecast      Lo 80    Hi 80     Lo 95     Hi 95
Aug 2003       2.853546 -1.4997363 7.206829 -3.804225  9.511317
Sep 2003       2.775261 -1.5812408 7.131763 -3.887434  9.437956
Oct 2003       2.825593 -1.5372596 7.188446 -3.846814  9.498001
Nov 2003       2.983553 -1.4010963 7.368202 -3.722189  9.689295
Dec 2003       3.468052 -0.9319463 7.868051 -3.261165 10.197270
Jan 2004       3.069170 -1.3486083 7.486949 -3.687239  9.825580
Feb 2004       3.188793 -1.2516060 7.629192 -3.602211  9.979797
Mar 2004       2.781775 -1.6772084 7.240758 -4.037651  9.601201
Apr 2004       2.852125 -1.6829376 7.387188 -4.083655  9.787905
May 2004       2.784457 -1.8555435 7.424457 -4.311811  9.880725
Jun 2004       2.937382 -1.7504400 7.625204 -4.232023 10.106787
Jul 2004       2.936065 -1.8366405 7.708770 -4.363158 10.235287
Aug 2004       2.993250 -1.8040829 7.790583 -4.343638 10.330138
Sep 2004       3.028177 -1.7963167 7.852671 -4.350250 10.406604
Oct 2004       3.026711 -1.8303437 7.883765 -4.401513 10.454935
Nov 2004       3.025585 -1.8629788 7.914149 -4.450828 10.501998
Dec 2004       2.945036 -1.9796080 7.869680 -4.586557 10.476630
Jan 2005       2.939578 -2.0303806 7.909537 -4.661318 10.540474
Feb 2005       2.912482 -2.1025800 7.927544 -4.757393 10.582357
Mar 2005       2.938223 -2.1255092 8.001955 -4.806087 10.682533
Apr 2005       2.946749 -2.1631616 8.056660 -4.868185 10.761684
May 2005       2.971948 -2.1746546 8.118551 -4.899101 10.842998
Jun 2005       2.977510 -2.2069181 8.161938 -4.951388 10.906408
Jul 2005       2.983404 -2.2348847 8.201692 -4.997280 10.964087
Aug 2005       2.977892 -2.2752248 8.231009 -5.056057 11.011841
Sep 2005       2.966312 -2.3236538 8.256278 -5.123993 11.056617
Oct 2005       2.958764 -2.3689909 8.286520 -5.189334 11.106863
Nov 2005       2.950182 -2.4162895 8.316653 -5.257128 11.157491
Dec 2005       2.953231 -2.4527752 8.359238 -5.314542 11.221005
Jan 2006       2.956054 -2.4881772 8.400286 -5.370179 11.282288
Feb 2006       2.962898 -2.5185424 8.444338 -5.420241 11.346037
Mar 2006       2.966105 -2.5515240 8.483734 -5.472380 11.404591
Apr 2006       2.968685 -2.5838601 8.521229 -5.523200 11.460569
May 2006       2.967324 -2.6203180 8.554966 -5.578237 11.512885
Jun 2006       2.965202 -2.6574703 8.587874 -5.633933 11.564337
Jul 2006       2.962239 -2.6957332 8.620211 -5.690883 11.615361
Aug 2006       2.960036 -2.7335262 8.653599 -5.747516 11.667589
Sep 2006       2.959730 -2.7693662 8.688826 -5.802166 11.721626
Oct 2006       2.960257 -2.8040879 8.724602 -5.855548 11.776062
Nov 2006       2.961986 -2.8372661 8.761238 -5.907205 11.831176
Dec 2006       2.963261 -2.8703602 8.796883 -5.958493 11.885016
Jan 2007       2.964197 -2.9034093 8.831804 -6.009533 11.937928
Feb 2007       2.964153 -2.9372055 8.865512 -6.061196 11.989502
Mar 2007       2.963695 -2.9712260 8.898616 -6.112983 12.040373
Apr 2007       2.962828 -3.0056282 8.931284 -6.165138 12.090794
May 2007       2.962178 -3.0397407 8.964098 -6.216965 12.141322
Jun 2007       2.961839 -3.0734322 8.997111 -6.268312 12.191990
Jul 2007       2.961899 -3.1065684 9.030366 -6.319021 12.242819
Aug 2007       2.962280 -3.1391609 9.063720 -6.369068 12.293627
Sep 2007       2.962682 -3.1714813 9.096845 -6.418711 12.344075
> forecast(diffModelARMA12,50)
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       4.023413 -0.1760861 8.222912 -2.399167 10.44599
Sep 2003       3.968090 -0.2369284 8.173107 -2.462930 10.39911
Oct 2003       3.929054 -0.2786503 8.136758 -2.506074 10.36418
Nov 2003       3.901510 -0.3074890 8.110510 -2.535599 10.33862
Dec 2003       3.882076 -0.3275389 8.091691 -2.555974 10.32013
Jan 2004       3.868363 -0.3415375 8.078264 -2.570124 10.30685
Feb 2004       3.858687 -0.3513409 8.068716 -2.579995 10.29737
Mar 2004       3.851860 -0.3582213 8.061942 -2.586904 10.29062
Apr 2004       3.847043 -0.3630577 8.057144 -2.591750 10.28584
May 2004       3.843644 -0.3664612 8.053750 -2.595156 10.28244
Jun 2004       3.841246 -0.3688581 8.051350 -2.597553 10.28004
Jul 2004       3.839554 -0.3705470 8.049655 -2.599240 10.27835
Aug 2004       3.838360 -0.3717377 8.048457 -2.600429 10.27715
Sep 2004       3.837517 -0.3725772 8.047612 -2.601267 10.27630
Oct 2004       3.836923 -0.3731693 8.047015 -2.601857 10.27570
Nov 2004       3.836503 -0.3735869 8.046594 -2.602274 10.27528
Dec 2004       3.836207 -0.3738815 8.046296 -2.602568 10.27498
Jan 2005       3.835999 -0.3740894 8.046086 -2.602775 10.27477
Feb 2005       3.835851 -0.3742360 8.045938 -2.602922 10.27462
Mar 2005       3.835747 -0.3743394 8.045834 -2.603025 10.27452
Apr 2005       3.835674 -0.3744124 8.045760 -2.603098 10.27445
May 2005       3.835622 -0.3744639 8.045708 -2.603149 10.27439
Jun 2005       3.835586 -0.3745003 8.045671 -2.603185 10.27436
Jul 2005       3.835560 -0.3745259 8.045646 -2.603211 10.27433
Aug 2005       3.835542 -0.3745440 8.045627 -2.603229 10.27431
Sep 2005       3.835529 -0.3745568 8.045614 -2.603241 10.27430
Oct 2005       3.835520 -0.3745658 8.045605 -2.603250 10.27429
Nov 2005       3.835513 -0.3745721 8.045599 -2.603257 10.27428
Dec 2005       3.835509 -0.3745766 8.045594 -2.603261 10.27428
Jan 2006       3.835506 -0.3745798 8.045591 -2.603264 10.27428
Feb 2006       3.835503 -0.3745820 8.045589 -2.603267 10.27427
Mar 2006       3.835502 -0.3745836 8.045587 -2.603268 10.27427
Apr 2006       3.835501 -0.3745847 8.045586 -2.603269 10.27427
May 2006       3.835500 -0.3745855 8.045585 -2.603270 10.27427
Jun 2006       3.835499 -0.3745860 8.045585 -2.603271 10.27427
Jul 2006       3.835499 -0.3745864 8.045584 -2.603271 10.27427
Aug 2006       3.835499 -0.3745867 8.045584 -2.603271 10.27427
Sep 2006       3.835499 -0.3745869 8.045584 -2.603272 10.27427
Oct 2006       3.835498 -0.3745870 8.045584 -2.603272 10.27427
Nov 2006       3.835498 -0.3745871 8.045584 -2.603272 10.27427
Dec 2006       3.835498 -0.3745872 8.045584 -2.603272 10.27427
Jan 2007       3.835498 -0.3745873 8.045584 -2.603272 10.27427
Feb 2007       3.835498 -0.3745873 8.045584 -2.603272 10.27427
Mar 2007       3.835498 -0.3745873 8.045584 -2.603272 10.27427
Apr 2007       3.835498 -0.3745873 8.045584 -2.603272 10.27427
May 2007       3.835498 -0.3745873 8.045584 -2.603272 10.27427
Jun 2007       3.835498 -0.3745873 8.045584 -2.603272 10.27427
Jul 2007       3.835498 -0.3745874 8.045584 -2.603272 10.27427
Aug 2007       3.835498 -0.3745874 8.045583 -2.603272 10.27427
Sep 2007       3.835498 -0.3745874 8.045583 -2.603272 10.27427
> forecast(diffModelARMA12)
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       4.023413 -0.1760861 8.222912 -2.399167 10.44599
Sep 2003       3.968090 -0.2369284 8.173107 -2.462930 10.39911
Oct 2003       3.929054 -0.2786503 8.136758 -2.506074 10.36418
Nov 2003       3.901510 -0.3074890 8.110510 -2.535599 10.33862
Dec 2003       3.882076 -0.3275389 8.091691 -2.555974 10.32013
Jan 2004       3.868363 -0.3415375 8.078264 -2.570124 10.30685
Feb 2004       3.858687 -0.3513409 8.068716 -2.579995 10.29737
Mar 2004       3.851860 -0.3582213 8.061942 -2.586904 10.29062
Apr 2004       3.847043 -0.3630577 8.057144 -2.591750 10.28584
May 2004       3.843644 -0.3664612 8.053750 -2.595156 10.28244
Jun 2004       3.841246 -0.3688581 8.051350 -2.597553 10.28004
Jul 2004       3.839554 -0.3705470 8.049655 -2.599240 10.27835
Aug 2004       3.838360 -0.3717377 8.048457 -2.600429 10.27715
Sep 2004       3.837517 -0.3725772 8.047612 -2.601267 10.27630
Oct 2004       3.836923 -0.3731693 8.047015 -2.601857 10.27570
Nov 2004       3.836503 -0.3735869 8.046594 -2.602274 10.27528
Dec 2004       3.836207 -0.3738815 8.046296 -2.602568 10.27498
Jan 2005       3.835999 -0.3740894 8.046086 -2.602775 10.27477
Feb 2005       3.835851 -0.3742360 8.045938 -2.602922 10.27462
Mar 2005       3.835747 -0.3743394 8.045834 -2.603025 10.27452
Apr 2005       3.835674 -0.3744124 8.045760 -2.603098 10.27445
May 2005       3.835622 -0.3744639 8.045708 -2.603149 10.27439
Jun 2005       3.835586 -0.3745003 8.045671 -2.603185 10.27436
Jul 2005       3.835560 -0.3745259 8.045646 -2.603211 10.27433
> ftest = forecast(diffModelARMA12)
> names(ftest)
 [1] "method"    "model"     "level"     "mean"      "lower"     "upper"     "x"        
 [8] "series"    "fitted"    "residuals"
> f1=ftest[1]
> f1
$method
[1] "ARIMA(1,1,2)"

> f1=ftest[2]
> f1
$model

Call:
arima(x = tornlents, order = c(1, 1, 2))

Coefficients:
         ar1      ma1     ma2
      0.7056  -1.7585  0.7585
s.e.  0.2401   0.2238  0.2240

sigma^2 estimated as 10.72:  log likelihood = -1675.88,  aic = 3359.76

> ftest
         Point Forecast      Lo 80    Hi 80     Lo 95    Hi 95
Aug 2003       4.023413 -0.1760861 8.222912 -2.399167 10.44599
Sep 2003       3.968090 -0.2369284 8.173107 -2.462930 10.39911
Oct 2003       3.929054 -0.2786503 8.136758 -2.506074 10.36418
Nov 2003       3.901510 -0.3074890 8.110510 -2.535599 10.33862
Dec 2003       3.882076 -0.3275389 8.091691 -2.555974 10.32013
Jan 2004       3.868363 -0.3415375 8.078264 -2.570124 10.30685
Feb 2004       3.858687 -0.3513409 8.068716 -2.579995 10.29737
Mar 2004       3.851860 -0.3582213 8.061942 -2.586904 10.29062
Apr 2004       3.847043 -0.3630577 8.057144 -2.591750 10.28584
May 2004       3.843644 -0.3664612 8.053750 -2.595156 10.28244
Jun 2004       3.841246 -0.3688581 8.051350 -2.597553 10.28004
Jul 2004       3.839554 -0.3705470 8.049655 -2.599240 10.27835
Aug 2004       3.838360 -0.3717377 8.048457 -2.600429 10.27715
Sep 2004       3.837517 -0.3725772 8.047612 -2.601267 10.27630
Oct 2004       3.836923 -0.3731693 8.047015 -2.601857 10.27570
Nov 2004       3.836503 -0.3735869 8.046594 -2.602274 10.27528
Dec 2004       3.836207 -0.3738815 8.046296 -2.602568 10.27498
Jan 2005       3.835999 -0.3740894 8.046086 -2.602775 10.27477
Feb 2005       3.835851 -0.3742360 8.045938 -2.602922 10.27462
Mar 2005       3.835747 -0.3743394 8.045834 -2.603025 10.27452
Apr 2005       3.835674 -0.3744124 8.045760 -2.603098 10.27445
May 2005       3.835622 -0.3744639 8.045708 -2.603149 10.27439
Jun 2005       3.835586 -0.3745003 8.045671 -2.603185 10.27436
Jul 2005       3.835560 -0.3745259 8.045646 -2.603211 10.27433
> ftest(1)
Error in ftest(1) : could not find function "ftest"
> ftest[,1]
Error in ftest[, 1] : incorrect number of dimensions
> ftest[30]
$<NA>
NULL

> ftest[23]
$<NA>
NULL

> ftest$mean
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                4.023413 3.968090
2004 3.868363 3.858687 3.851860 3.847043 3.843644 3.841246 3.839554 3.838360 3.837517
2005 3.835999 3.835851 3.835747 3.835674 3.835622 3.835586 3.835560                  
          Oct      Nov      Dec
2003 3.929054 3.901510 3.882076
2004 3.836923 3.836503 3.836207
2005                           
> 
> 
> #
> 
> 
> #since three models returned the near equivalent RMSE values, we need to compare them to choose the bset
> 
> #applying two sample paired hypothesis testing for the models
> 
> 
> #retrieving the forecasted values for MA(1) model
> 
> ma1forecast = forecast(diffModelMA1,36)
> ma1forecast = forecast(diffModelMA1,36)$mean
> malforecast
Error: object 'malforecast' not found
> ma1forecast
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep
2003                                                                3.833215 3.833215
2004 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215
2005 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215
2006 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215 3.833215                  
          Oct      Nov      Dec
2003 3.833215 3.833215 3.833215
2004 3.833215 3.833215 3.833215
2005 3.833215 3.833215 3.833215
2006                           
> ma1forecast = forecast(diffModelMA1,108)$mean
> 
> 
> #retrieving the forecasted values for ARMA(1,2) model
> 
> arma12forecast = forecast(diffModelARMA12,108)$mean
> 
> 
> #perform two sample paired hypothesis testing now to arrive at which model is best
> 
> 
> accuracy(forecast(diffModelAR10),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
Test set     1.523244020 3.856371 2.527493 -36.43349  87.5829 0.8206137 -0.164305757
             Theil's U
Training set        NA
Test set      1.032556
> accuracy(forecast(diffModelAR10),testlen)
Error in testaccuracy(f, x, test, d, D) : 
  Not enough forecasts. Check that forecasts and test data match.
> accuracy(forecast(diffModelAR10),108,testlen)
               ME     RMSE      MAE      MPE     MAPE     MASE
Test set 105.1465 105.1465 105.1465 97.35783 97.35783 32.70702
Warning message:
In testaccuracy(f, x, test, d, D) : test elements must be within sample
> accuracy(forecast(diffModelAR10),testlen)
Error in testaccuracy(f, x, test, d, D) : 
  Not enough forecasts. Check that forecasts and test data match.
> accuracy(forecast(diffModelAR10),108,testlents)
               ME     RMSE      MAE      MPE     MAPE     MASE
Test set 105.1465 105.1465 105.1465 97.35783 97.35783 32.70702
Warning message:
In testaccuracy(f, x, test, d, D) : test elements must be within sample
> accuracy(forecast(diffModelAR10),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
Test set     1.523244020 3.856371 2.527493 -36.43349  87.5829 0.8206137 -0.164305757
             Theil's U
Training set        NA
Test set      1.032556
> accuracy(forecast(diffModelAR10),tornlents,testlents)
Error in window.default(x, ...) : 'start' cannot be after 'end'
In addition: Warning message:
In window.default(x, ...) : 'start' value not changed
> accuracy(forecast(diffModelAR10),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712
Test set     1.523244020 3.856371 2.527493 -36.43349  87.5829 0.8206137 -0.164305757
             Theil's U
Training set        NA
Test set      1.032556
> ma1fore = na.omitma1forecast
Error: object 'na.omitma1forecast' not found
> ma1fore = na.omit(ma1forecast)
> arma12fore = na.omit(arma12forecast)
> ma1fore - arma12fore
              Jan          Feb          Mar          Apr          May          Jun
2003                                                                              
2004 -0.035147893 -0.025472209 -0.018645107 -0.013827945 -0.010428986 -0.008030701
2005 -0.002783294 -0.002635948 -0.002531981 -0.002458623 -0.002406862 -0.002370340
2006 -0.002290430 -0.002288186 -0.002286603 -0.002285486 -0.002284697 -0.002284141
2007 -0.002282924 -0.002282890 -0.002282866 -0.002282849 -0.002282837 -0.002282828
2008 -0.002282810 -0.002282809 -0.002282809 -0.002282809 -0.002282809 -0.002282808
2009 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2010 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2011 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2012 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
              Jul          Aug          Sep          Oct          Nov          Dec
2003              -0.190197554 -0.134874294 -0.095838544 -0.068295158 -0.048860716
2004 -0.006338486 -0.005144469 -0.004301979 -0.003707522 -0.003288078 -0.002992120
2005 -0.002344570 -0.002326387 -0.002313557 -0.002304504 -0.002298117 -0.002293610
2006 -0.002283749 -0.002283472 -0.002283276 -0.002283139 -0.002283041 -0.002282973
2007 -0.002282822 -0.002282818 -0.002282815 -0.002282813 -0.002282812 -0.002282811
2008 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2009 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2010 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2011 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808 -0.002282808
2012 -0.002282808                                                                 
> difference = arma12fore-ma1fore
> library(BSDA)
Loading required package: lattice

Attaching package: ‘BSDA’

The following object is masked from ‘package:datasets’:

    Orange

Warning message:
package ‘BSDA’ was built under R version 3.4.2 
> z.test(difference,y=NULL,alternative = "greater",mu=0,sigma.x=sd(difference),sigma.y=NULL,conf.level=0.95)

        One-sample z-Test

data:  difference
z = 3.414, p-value = 0.0003201
alternative hypothesis: true mean is greater than 0
95 percent confidence interval:
 0.004245539          NA
sample estimates:
  mean of x 
0.008192845 

> z.test(difference,y=NULL,alternative = "two.sided",mu=0,sigma.x=sd(difference),sigma.y=NULL,conf.level=0.95)

        One-sample z-Test

data:  difference
z = 3.414, p-value = 0.0006402
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.00348934 0.01289635
sample estimates:
  mean of x 
0.008192845 

> z.test(arma12fore,y=ma1fore,alternative = "two.sided",mu=0,sigma.x=sd(arma12fore),sigma.y=sd(ma1fore),conf.level=0.95)

        Two-sample z-Test

data:  arma12fore and ma1fore
z = 3.414, p-value = 0.0006402
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.00348934 0.01289635
sample estimates:
mean of x mean of y 
 3.841408  3.833215 

> nrow(ma1fore)
NULL
> NROW(ma1fore)
[1] 108
> NROW(arma12fore)
[1] 108
> plot(forecast(diffModelMA1),108)
> plot(forecast(diffModelARMA12),108)
> plot(forecast(diffModelMA1),300)
> plot(forecast(diffModelMA1,testlents))
Error in ts(z[[1L]] + xm, start = xtsp[2L] + deltat(rsd), frequency = xtsp[3L]) : 
  'ts' object must have one or more observations
> plot(forecast(diffModelMA1),108,300)
> forecast(diffModelMA1,h=h)
Error in KalmanForecast(n.ahead, object$model) : object 'h' not found
> 
> 
> 
> 
> 
> #since the three models built have similar AIC values and RMSE values we need hypothesis testing to confirm 
> #whether the models are different or one and the same
> 
> 
> #get the first 36 forecast values of MA(1) model
> 
> 
> ma1forecast=forecast(diffModelMa1)$mean
Error in forecast(diffModelMa1) : object 'diffModelMa1' not found
> 
> ma1forecast=forecast(diffModelMA1)$mean
> 
> 
> #get the first 36 forecast values of ARMA(1,2) model
> 
> arma12forecast = forecast(diffModelARMA12)$mean
> 
> 
> #since forecasts are for the same data but with two different models, this would be a two sample paired testing
> 
> #two sample paired testing will become one-sample testing by taking the difference of these two
> 
> #calcualting the differences for hypotheis
> 
> fordifference = arma12forecast - ma1forecast
> 
> 
> #perform the hypothesis testing
> 
> z.test(foredifference,NULL,alternative="two.sided",mu=0,sigma.x=sd(fordifference),sigma.y=NULL,conf.level=0.95)
Error in z.test(foredifference, NULL, alternative = "two.sided", mu = 0,  : 
  object 'foredifference' not found
> z.test(fordifference,NULL,alternative="two.sided",mu=0,sigma.x=sd(fordifference),sigma.y=NULL,conf.level=0.95)

        One-sample z-Test

data:  fordifference
z = 2.9367, p-value = 0.003318
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.009602338 0.048141276
sample estimates:
 mean of x 
0.02887181 

> 
> 
> #Hypothesis states that the models diffModelMA1 and diffModelARMA12 are different . 
> #hence we can choose the one with low RMSE value as the best model i.e.. the MA(1) model
> 
> 
> #plotting the prediction graph and forecast graphs with the model MA(1)
> 
> 
> #prediction graph
> 
> x.fore=predict(diffModelMA1,n.ahead=120)
> U=x.fore$pred + 2*x.fore$se
> L=x.fore$pred - 2*x.fore$se
> minx=min(tornlents,L)
> maxx=max(tornlents,U)
> ts.plot(tornlents,x.fore$pred,col=1:2,ylim=c(minx,maxx))
> lines(U,col="blue",lty="dashed",lwd=2)
> lines(L,col="blue",lty="dashed",lwd=2)
> 
> 
> #forecast graph
> 
> plot(forecast(diffModelMA1),120)
> 
> 
> plot.forecast(forecast(diffModelMA1),120)
Error in plot.forecast(forecast(diffModelMA1), 120) : 
  could not find function "plot.forecast"
> auto.arima(tornlents)
Series: tornlents 
ARIMA(0,0,0) with non-zero mean 

Coefficients:
        mean
      3.8332
s.e.  0.1294

sigma^2 estimated as 10.79:  log likelihood=-1676.51
AIC=3357.01   AICc=3357.03   BIC=3365.94
> auto.arima(tornlentsdiff)
Series: tornlentsdiff 
ARIMA(1,0,0)(1,0,0)[12] with non-zero mean 

Coefficients:
          ar1    sar1    mean
      -0.5030  0.0100  0.0013
s.e.   0.0341  0.0395  0.1089

sigma^2 estimated as 16.93:  log likelihood=-1817.81
AIC=3643.62   AICc=3643.68   BIC=3661.48
> 
> 
> #display the summary of AR10 Model
> 
> 
> diffModelAR10

Call:
arima(x = tornlents, order = c(10, 1, 0))

Coefficients:
          ar1      ar2      ar3      ar4      ar5     ar6      ar7      ar8      ar9     ar10
      -0.9615  -0.9090  -0.8128  -0.7388  -0.6644  -0.586  -0.5239  -0.3720  -0.1988  -0.1151
s.e.   0.0393   0.0541   0.0633   0.0679   0.0701   0.070   0.0677   0.0631   0.0540   0.0393

sigma^2 estimated as 11.54:  log likelihood = -1696.99,  aic = 3415.97
> 
> 
> #display the summary of MA1 model
> 
> 
> diffModelMA1

Call:
arima(x = tornlents, order = c(0, 1, 1))

Coefficients:
          ma1
      -1.0000
s.e.   0.0047

sigma^2 estimated as 10.79:  log likelihood = -1677.63,  aic = 3359.26
> save.image("E:\\MITM\\Fall 2017\\ITMD527\\RProject\\fulltornadoes\\timeseries\\Timeseries_12042017.RData")
> 
> 
> 
> forecast(diffModelAR10)
         Point Forecast      Lo 80    Hi 80     Lo 95     Hi 95
Aug 2003       2.853546 -1.4997363 7.206829 -3.804225  9.511317
Sep 2003       2.775261 -1.5812408 7.131763 -3.887434  9.437956
Oct 2003       2.825593 -1.5372596 7.188446 -3.846814  9.498001
Nov 2003       2.983553 -1.4010963 7.368202 -3.722189  9.689295
Dec 2003       3.468052 -0.9319463 7.868051 -3.261165 10.197270
Jan 2004       3.069170 -1.3486083 7.486949 -3.687239  9.825580
Feb 2004       3.188793 -1.2516060 7.629192 -3.602211  9.979797
Mar 2004       2.781775 -1.6772084 7.240758 -4.037651  9.601201
Apr 2004       2.852125 -1.6829376 7.387188 -4.083655  9.787905
May 2004       2.784457 -1.8555435 7.424457 -4.311811  9.880725
Jun 2004       2.937382 -1.7504400 7.625204 -4.232023 10.106787
Jul 2004       2.936065 -1.8366405 7.708770 -4.363158 10.235287
Aug 2004       2.993250 -1.8040829 7.790583 -4.343638 10.330138
Sep 2004       3.028177 -1.7963167 7.852671 -4.350250 10.406604
Oct 2004       3.026711 -1.8303437 7.883765 -4.401513 10.454935
Nov 2004       3.025585 -1.8629788 7.914149 -4.450828 10.501998
Dec 2004       2.945036 -1.9796080 7.869680 -4.586557 10.476630
Jan 2005       2.939578 -2.0303806 7.909537 -4.661318 10.540474
Feb 2005       2.912482 -2.1025800 7.927544 -4.757393 10.582357
Mar 2005       2.938223 -2.1255092 8.001955 -4.806087 10.682533
Apr 2005       2.946749 -2.1631616 8.056660 -4.868185 10.761684
May 2005       2.971948 -2.1746546 8.118551 -4.899101 10.842998
Jun 2005       2.977510 -2.2069181 8.161938 -4.951388 10.906408
Jul 2005       2.983404 -2.2348847 8.201692 -4.997280 10.964087
> accuracy(forecast(diffModelAR10),testlents)
                      ME     RMSE      MAE       MPE     MAPE      MASE         ACF1 Theil's U
Training set 0.008595612 3.394242 2.311455 -87.71028 115.6306 0.7504714 -0.009522712        NA
Test set     1.523244020 3.856371 2.527493 -36.43349  87.5829 0.8206137 -0.164305757  1.032556
> 
> 
> 
> ma1forecast-testlen
Error in `-.default`(ma1forecast, testlen) : 
  time-series/vector length mismatch
> ma1forecast-testlents
              Jan          Feb          Mar          Apr          May          Jun          Jul
2004   3.34154858   3.19988192   1.47821525  -0.64264682  -1.41053475  -0.93122919   2.07721525
2005   1.17488192   0.06398448  -7.01053475   0.86398448   1.81178668 -11.16678475   0.20629217
              Aug          Sep          Oct          Nov          Dec
2004  -0.74829735   2.37384025  -2.81678475   0.20299942  -4.41678475
2005                                                                 
> arma12forecast-testlents
              Jan          Feb          Mar          Apr          May          Jun          Jul          Aug          Sep          Oct          Nov
2004   3.37669648   3.22535413   1.49686036  -0.62881887  -1.40010576  -0.92319849   2.08355374  -0.74315288   2.37814223  -2.81307723   0.20628750
2005   1.17766521   0.06662043  -7.00800277   0.86644311   1.81419354 -11.16441441   0.20863674                                                    
              Dec
2004  -4.41379263
2005             
> ma1absoluteerror = ma1forecast-testlents
> arma12absoluteerror = arma12forecast-testlents
> 
> 
> 
> 
> 
> 
> #calculate the absolute error for MA(1) model
> 
> ma1absoluteerror = ma1forecast-testlents
> 
> 
> #calculate the absolute error for ARMA(1,2) model
> 
> 
> arma12absoluteerror = arma12forecast-testlents
> 
> 
> 
> #calculate the difference in absolute error between models
> 
> 
> absoluteerrordiff = arma12absoluteerror - ma1absoluteerror
> 
> 
> 
> #conduct hypothesis testing to see if the RMSE of models MA(1) and ARMA(1,2) 
> 
> 
> 
> #H0:Errors of models MA(1) and ARMA(1,2) are the same
> #Ha: Errors of models MA(1) and ARMA(1,2) are not the same
> 
> 
> #two paired sample two tailed hypothesis testing
> 
> 
> z.test(absoluteerrordiff,NULL,alternative="two.sided",mu=0,sigma.x=sd(absoluteerrordiff),sigma.y=NULL,conf.level=0.95)

        One-sample z-Test

data:  absoluteerrordiff
z = 3.8958, p-value = 9.788e-05
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.004049938 0.012250810
sample estimates:
  mean of x 
0.008150374 

> #Since the sample size is less than 30, we will perform t test 
> 
> 
> t.test(ma1absoluteerror,arma12absoluteerror,alternative="two.sided
+ ",mu=0,paired=T,var.equal=T,conf.level=0.95)
Error in match.arg(alternative) : 
  'arg' should be one of “two.sided”, “less”, “greater”
> t.test(ma1absoluteerror,arma12absoluteerror,alternative="two.sided",mu=0,paired=T,var.equal=T,conf.level=0.95)

        Paired t-test

data:  ma1absoluteerror and arma12absoluteerror
t = -3.8958, df = 18, p-value = 0.001059
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.01254571 -0.00375504
sample estimates:
mean of the differences 
           -0.008150374 

